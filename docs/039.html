<html>
<head>
<title>AutoML Solutions: What I Like and Don’t Like About AutoML as a Data Scientist </title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>AutoML解决方案:作为一名数据科学家，我喜欢和不喜欢AutoML的地方</h1>
<blockquote>原文：<a href="https://web.archive.org/web/https://neptune.ai/blog/automl-solutions#0001-01-01">https://web.archive.org/web/https://neptune.ai/blog/automl-solutions#0001-01-01</a></blockquote><div><div class="l-content content-wrapper js-content">
            
<p>有一种观点认为，AutoML可能会让很多数据科学家失业。会吗？简而言之，没有。事实上，即使AutoML解决方案变得更好10倍，它也不会使任何行业的机器学习专家变得无关紧要。</p>



<p>你可能会问，为什么这么乐观？因为尽管AutoML是一个技术奇迹，但它并不是灵丹妙药。数据科学家做的大部分工作不是建模，而是数据收集、领域理解、弄清楚如何设计一个好的实验，以及哪些功能对后续的建模/预测问题最有用。大多数ML工程师和其他数据专业人员也是如此。</p>


<div class="wp-block-image">
<figure class="aligncenter size-full"><img decoding="async" src="../Images/e4ce84fb8e785003e7a7c5164c8cabdb.png" alt="AutoML - ML workflow" class="wp-image-66886" data-recalc-dims="1" data-original-src="https://web.archive.org/web/20221201161809im_/https://i0.wp.com/neptune.ai/wp-content/uploads/2022/10/AutoML-ML-workflow.png?ssl=1"/><figcaption><em>Inspired by <a href="https://web.archive.org/web/20221201161809/https://en.wikipedia.org/wiki/Cross-industry_standard_process_for_data_mining">CRISP-DM</a> workflow, but with all the real-world feedback loops | Image by author</em></figcaption></figure></div>


<p>事实上，AutoML听起来像某种算法魔术，在接收到你的标记数据后，会输出最好的ML模型。说实话，AutoML有点像与精灵互动:<em>“小心你的愿望”</em>，或者更确切地说，你给它什么数据。</p>



<p>还记得那句谚语吗，垃圾进——垃圾出？由于AutoML系统中额外的反馈回路，与经典的ML解决方案相比,“垃圾”会被放大到超出你的想象。我个人不够小心，几次落入这个陷阱，但后来更多。</p>


<div class="wp-block-image">
<figure class="aligncenter size-full"><img decoding="async" src="../Images/68238d48f9c99924bc2e324d591b7bb2.png" alt="AutoML - ML workflow " class="wp-image-66888" data-recalc-dims="1" data-original-src="https://web.archive.org/web/20221201161809im_/https://i0.wp.com/neptune.ai/wp-content/uploads/2022/10/AutoML-ML-workflow-2.png?ssl=1"/><figcaption><em>Based on personal experience and the references at the end of the article | Image by author</em></figcaption></figure></div>


<p>在做出任何声明之前，我们首先需要了解AutoML是什么，它不是什么。</p>



<h2 id="h-the-current-state-of-automl">AutoML的当前状态</h2>



<p>实际上，AutoML可以采取不同的形式。有时一个相对有效的超参数优化工具(HPO)可以选择不同的ML算法，可以被称为AutoML工具。几个值得注意的例子是<a href="https://web.archive.org/web/20221201161809/http://epistasislab.github.io/tpot/" target="_blank" rel="noreferrer noopener nofollow"> TPOT </a>、<a href="https://web.archive.org/web/20221201161809/http://autokeras.com/" target="_blank" rel="noreferrer noopener nofollow"> AutoKeras </a>、<a href="https://web.archive.org/web/20221201161809/https://docs.h2o.ai/h2o/latest-stable/h2o-docs/automl.html" target="_blank" rel="noreferrer noopener nofollow"> H2O.ai AutoML </a>(不要和<a href="https://web.archive.org/web/20221201161809/https://h2o.ai/products/h2o-driverless-ai/" target="_blank" rel="noreferrer noopener nofollow">无人驾驶. ai </a>混淆)。我甚至可以推测，如果有一个GUI/Web界面来与这些工具进行交互，并且有足够的营销预算，人们可以利用这些工具创建一个创业公司。</p>


<div class="wp-block-image">
<figure class="aligncenter size-large is-resized"><img decoding="async" loading="lazy" src="../Images/2a20e0e89266bffbe036d5ae06041c0e.png" alt="Example AutoML loop" class="wp-image-66890" data-recalc-dims="1" data-original-src="https://web.archive.org/web/20221201161809im_/https://i0.wp.com/neptune.ai/wp-content/uploads/2022/10/Example-AutoML-loop.png?resize=840%2C399&amp;ssl=1"/><figcaption><em>An example AutoML loop. Image by TPOT from Epistasis Labs | <a href="https://web.archive.org/web/20221201161809/http://epistasislab.github.io/tpot/" target="_blank" rel="noreferrer noopener nofollow">Source</a></em></figcaption></figure></div>


<p>对于一些深度学习的人来说，AutoML将是关于NAS，又名<strong>网络架构搜索</strong>算法或方法。这些方法实际上是一个非常有趣的研究方向，给我们带来了EfficientNet、AmoebaNet等计算机视觉架构，以及像<a href="https://web.archive.org/web/20221201161809/https://arxiv.org/abs/1806.09055" target="_blank" rel="noreferrer noopener nofollow">飞镖</a>、<a href="https://web.archive.org/web/20221201161809/https://arxiv.org/abs/1802.03268" target="_blank" rel="noreferrer noopener nofollow"> ENAS </a>、<a href="https://web.archive.org/web/20221201161809/https://arxiv.org/abs/1712.00559" target="_blank" rel="noreferrer noopener nofollow"> PNAS </a>等方法。几个著名的NAS开源工具是<a href="https://web.archive.org/web/20221201161809/https://nni.readthedocs.io/" target="_blank" rel="noreferrer noopener nofollow">微软的NNI </a>和<a href="https://web.archive.org/web/20221201161809/https://auto.gluon.ai/" target="_blank" rel="noreferrer noopener nofollow"> MXNet自动增长</a>。</p>



<p>回想一下我对<strong> <em> HPO +尼斯界面==利润</em> </strong>的猜测？这更多的是一种简化，但一些公司确实这样做了，当然增加了功能、可扩展性、安全性和客户服务，这很有效，它确实帮助组织让数据科学家解决了许多问题。H2O的无人驾驶. ai可能是这类解决方案中最知名的，但部分<a href="https://web.archive.org/web/20221201161809/https://www.datarobot.com/" target="_blank" rel="noreferrer noopener nofollow"> DataRobot </a>和<a href="https://web.archive.org/web/20221201161809/https://www.dataiku.com/" target="_blank" rel="noreferrer noopener nofollow">data aiku的</a>产品也在一个易于使用的界面后面进行自动管理。</p>



<p>我相信特别值得一提的是来自Google、Azure和AWS等云巨头的AutoML产品。我没有太多使用Azure和AWS的经验，但我可以谈谈我使用<a href="https://web.archive.org/web/20221201161809/https://cloud.google.com/automl" target="_blank" rel="noreferrer noopener nofollow"> Google的Vision AutoML </a>的经验。根据我的实验和知识，这些解决方案是在面向开发人员的产品中实际使用NAS的少数几个解决方案之一，这太棒了。</p>



<p>请注意，NAS不会用于快速运行。我最后一次检查，特别是Google Vision AutoML使用迁移学习进行快速运行，使用NAS进行24小时运行。我已经有一段时间没检查过了。</p>



<p>让我们把这些信息组织一下，好吗？下面的表格应该让你从高层次上了解不同的工具是如何以这样或那样的方式实现AutoML的。</p>



<div id="medium-table-block_629f4a8fc5b9d" class="block-medium-table c-table__outer-wrapper ">

    <table class="c-table">
                    <thead class="c-table__head">
            <tr>
                                    <td class="c-item">
                        <p class="c-item__inner">名字</p>
                    </td>
                                    <td class="c-item">
                        <p class="c-item__inner">开源？</p>
                    </td>
                                    <td class="c-item">
                        <p class="c-item__inner">本地还是托管？</p>
                    </td>
                                    <td class="c-item">
                        <p class="c-item__inner">特征</p>
                    </td>
                                    <td class="c-item">
                        <p class="c-item__inner">类型</p>
                    </td>
                            </tr>
            </thead>
        
        <tbody class="c-table__body">

                    
                <tr class="c-row">

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil"><div class="c-ceil__inner"><p>【HPO+NAS+其他一些有趣的东西</p> </div></td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                </tr>

            
                <tr class="c-row">

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil"><div class="c-ceil__inner"> <p> NAS，支持处罚大型号</p> </div></td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                </tr>

            
                <tr class="c-row">

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil"><div class="c-ceil__inner"> <p> NAS，根据场景有基准它首先尝试</p> </div></td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                </tr>

            
                <tr class="c-row">

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil"><div class="c-ceil__inner"> <p>构建预处理+算法+集成流水线</p> </div></td>

                    
                        <td class="c-ceil"><div class="c-ceil__inner"><p>【HPO++】，其实用的是遗传算法</p> </div></td>

                    
                </tr>

            
                <tr class="c-row">

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil"><div class="c-ceil__inner"> <p>采用多种预处理、特征编码和选择方案</p> </div></td>

                    
                        <td class="c-ceil"><div class="c-ceil__inner"><p><span>【HPO ++拥有更好的UI，w综合评测</span> </p> </div></td>

                    
                </tr>

            
                <tr class="c-row">

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil"><div class="c-ceil__inner"> <p>基本上是免费版的无人驾驶. ai </p> </div></td>

                    
                        <td class="c-ceil"><div class="c-ceil__inner"> <p> HPO++，有Web UI，w综合评测</p> </div></td>

                    
                </tr>

            
                <tr class="c-row">

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil"><div class="c-ceil__inner"> <p>基本上是托管的，简单使用NAS </p> </div></td>

                    
                        <td class="c-ceil"><div class="c-ceil__inner"> <p>转移学习+ NAS，极简UI与w综合评测</p> </div></td>

                    
                </tr>

            
                <tr class="c-row">

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil"><div class="c-ceil__inner"> <p>具有XAI、推理服务器、模型和实验管理的集成平台</p> </div></td>

                    
                        <td class="c-ceil"><div class="c-ceil__inner"> <p> AutoML部分好像是HPO++ w综合评测和XAI还有一大堆其他玩意儿</p> </div></td>

                    
                </tr>

                    
        </tbody>
    </table>

</div>



<p id="separator-block_629f6733f045c" class="block-separator block-separator--20"> </p>



<p>从根本上说，AutoML是在用计算预算(或时间)换取专业知识。如果你不知道如何解决问题，你会选择最大可能的搜索空间，等待搜索完成。另一方面，如果你想削减强大服务器的开支，或者不想等一个星期才得到结果，<strong>和</strong> <strong>知道一些关于你的问题</strong>的事情，你可以减少搜索空间，更快地找到解决方案。</p>



<p>AutoML应该更像是一个探索工具，而不是一个最佳的模型生成工具。它不能替代数据/ML专业人员。</p>







<h2 id="h-automl-the-good-parts-pros">AutoML–好零件(优点)</h2>



<p>好的，我认为我们已经确定AutoML不是解决所有ML问题的灵丹妙药。那AutoML有什么用？</p>



<h3>加快模式探索阶段</h3>



<p>老实说，对于我们大多数人来说，通常我们在自己工作的领域并不特别有经验。注意，我说的领域不是指计算机视觉、NLP或时间序列，而是指广告、电子商务、金融、细胞生物学、基因组学，这个列表还可以更长。为了应对挑战，企业需要快速有效的结果。</p>



<p>我有一个半个人的故事，讲的是AutoML如何在有专业知识的人和没有专业知识的人之间架起一座桥梁。几年前，我在一个关于深度学习和强化学习的暑期学校。组织者安排了一个Kaggle比赛，基本上是试图预测一些时间序列。我有意省略了细节，你知道，这是半个人化的，所以…无论如何，有博士和博士后，都试图适应极其复杂的模型，其他一些人专注于创造有意义的功能。我，对于处理时间序列的知识有点浅薄，加上纯粹的懒惰，决定我可以只使用AutoML，即TPOT。事先没有太多EDA，功能工程就更不用说了。我的成绩大约在第50百分位。现在，你认为获奖作品是什么？也是TPOT，但进行了基本的异常值删除，将日期和时间转换为分类特征，如<em> is_it_weekend </em>等，并运行TPOT 2天。</p>



<blockquote class="wp-block-quote"><p>这个故事的寓意是——如果你缺乏专业知识，或者没有时间学习，或者只是懒惰，AutoML是一个相当好的起点。这也释放了时间去开发那些特性，从我的故事中可以看出，特性确实有所不同。</p></blockquote>



<p>虽然我的故事表明了这一点，但这并不总是关于交付最终的模型，有时分析生成的候选模式也会有所帮助。例如，无论最佳解决方案是使用朴素贝叶斯、决策树、线性分类器，还是AutoML试图创建越来越复杂的集成，这意味着您还需要一个非常有表现力的模型来解决您的问题。</p>



<h3>非常好的基线</h3>



<p>所以，你在做一个新的ML项目。你做的第一件事，就模型而言——你实现一个简单的启发式基线，然后看看你在哪里。第二，您尝试一个简单的ML解决方案，并分析它对基线的改善程度。在这个阶段之后，你可以尝试做的一件事，至少是我喜欢做的，是尝试估计你的预测性能上限，让AutoML解决方案最大限度地利用你的数据和预处理。</p>



<blockquote class="wp-block-quote"><p>它不仅有时会快速地交付卓越的结果，而且还会将您的感知转移到更好的功能上。</p></blockquote>



<p>请注意，有时您没有资源或者受到其他一些因素的限制。所以YMMV，但是在处理新项目时，一定要记住AutoML的这个用例。</p>



<h3>快速识别–什么有效，什么无效？</h3>



<p>特征变换、算法、它们的超参数以及组合所述算法的方式的可能组合的空间创建了可能的ML模型的巨大搜索空间。即使你知道对于给定的问题，什么解决方案可行，什么不可行，这仍然是一个巨大的搜索空间。AutoML可以帮助相当快速地测试什么配置更有可能工作。</p>



<p>“怎么会？”你可能会问。通过多次运行AutoML，并跟踪:</p>



<ul><li>哪些配置更常被选中，</li><li>多久一次，</li><li>丢弃的是什么，</li><li>它下降的速度有多快，</li><li>诸如此类。</li></ul>



<p>在某种程度上，这是某种meta-EDA。有人可能会说——探索性模型分析。</p>



<p>你为什么会对它感兴趣？我们想要最好的模型，为什么不直入主题呢？因为我们的目标不是一个好的最终模型，而是了解什么可行，什么不可行。基于这种理解，我们可以更好地解决问题。即使有了AutoML，也没有人能让你免除这些可爱的问题，比如需要定期根据新数据重新训练你的模型，以及试图减少ML的预算支出。</p>



<h2 id="h-automl-the-bad-parts-cons">AutoML–坏零件(缺点)</h2>



<h3>虚假的安全感</h3>



<p>老实说，这是我最讨厌AutoML的一点。感觉像魔法一样，让你变懒。就像任何自动化一样，你用得越多，失败的灾难性就越大。</p>



<p>正因为如此，很容易引入数据bug。由于AutoML有时不透明的性质，这些错误很难被发现。</p>



<p>关于这一点，我也有一个亲身经历——一个我可能永远不会厌倦回忆的经历。我们正在研究一个细胞分类问题，阳性和阴性细胞之间的区别即使对人类来说也很难观察到。只有中小企业才能对这些图像进行准确的分类。我们花了几个月的时间试图创建一个计算机视觉模型来自动化这项任务。结果并不好。即使是最定制的解决方案，考虑了我们数据集的各种属性，能够从少量数据中学习而不会过度拟合，准确率也接近69%。关于一个二元分类问题。</p>



<p>在那个阶段，我们有机会使用仍处于测试阶段的Google Vision AutoML。快速测试的结果比我们的稍差。最终，我们决定运行完整的训练，这有点昂贵，为了充分利用我们的数据，我们手动增加图像以增加数据集的大小。你瞧，98.8%的准确率。大获成功！</p>



<p>只有我对此表示怀疑。经过几个月失败的实验，尝试了数百个超参数，使用了数十种方法，我无法相信一些NAS可以解决这个问题，并且以光年为单位。我的上司正准备向投资者和其他利益相关者宣布我们出色的业绩。我坚持要我们检查一下发生了什么事。几个星期后，通过几十张部分遮挡的图片，完全的困惑和绝望，我想通了。</p>



<p>在使用Google Vision AutoML之前，我们手动扩充了数据集，但我们没有手动指定拆分。因此，同一图像的增强版本处于训练、测试和验证分割中。模特只是记住了图像。一旦我们修复了它并再次运行它，我们得到了大约67%。</p>



<blockquote class="wp-block-quote"><p>这个故事的寓意是——不要对AutoML感到舒服，它会在背后咬你一口。</p></blockquote>



<h3>倾向于过度优化/过度拟合</h3>



<p>根据数据的性质和模型验证设置，一些AutoML解决方案很容易过度拟合。我所说的数据本质是指它的属性，比如标签分布、有多少异常值以及数据集的整体质量。公平地说，通常不是工具的错，而是你的错，这意味着大多数时候过度拟合的原因在你的评估设置中。所以，注意你如何评估候选人，你如何分割你的数据，如果使用<a href="/web/20221201161809/https://neptune.ai/blog/category/time-series-forecasting" target="_blank" rel="noreferrer noopener">时间序列</a>——我不羡慕你。像对待<a href="/web/20221201161809/https://neptune.ai/blog/hyperparameter-tuning-in-python-complete-guide" target="_blank" rel="noreferrer noopener">超参数优化</a>一样对待AutoML过程，并使用类似<a href="https://web.archive.org/web/20221201161809/https://weina.me/nested-cross-validation/">嵌套交叉验证</a>的东西相应地分割你的数据。</p>







<h3>过于强调优化</h3>



<p>正如已经提到过几次的，正确的思考方式是把AutoML看作一个使能器，让你更关注事物的数据方面。但是在现实中，许多人陷入了模型超参数和一般模型是ML项目中最重要的因素的想法，因为AutoML解决方案有时可以显示出极好的改进，加强了这种想法。</p>



<h3>由此产生的模型部署起来可能会很乏味</h3>



<p>我曾经有机会，或者不幸，取决于你什么时候问我，从事广告价格预测。最终，我尝试使用AutoML，也就是TPOT。它运行得很好，并且给出了非常好的结果，所以我们决定部署我们性能最好的模型。我被要求将模型转换成Golang或者至少Java后端能够理解的东西，因为部署Python服务是不可行的。</p>



<p>经过几个小时的研究，我发现了PMML，而且我已经知道了ONNX。长话短说，<a href="https://web.archive.org/web/20221201161809/https://en.wikipedia.org/wiki/Predictive_Model_Markup_Language" target="_blank" rel="noreferrer noopener nofollow">PMML</a>-有能力的libs在他们能阅读的模型上有很大的不同。因此，虽然我的由TPOT生成的整体Python模型转换成PMML格式没什么问题，但让一个围棋程序明白这是不可能的。为什么？因为Go lib不知道如何处理集成、预处理和大多数模型，除了一些决策树、线性分类器，也许还有朴素贝叶斯。至于ONNX，将scikit-learn集成管道转换为ONNX也被证明是有问题的。</p>



<p>通常，AutoML候选模型会变得非常复杂，将它们转换成任何东西都会变得令人头痛。这就是为什么许多生产ML主要基于线性分类器、朴素贝叶斯和随机森林以及GBDTs。您很少会看到不同分类器的复杂堆叠集合。它们天生就很慢，而且很难快速运行或与非Python环境兼容。</p>



<h3>难以分析/调试模型</h3>



<p>回想一下Google Vision AutoML的故事。谷歌没有任何设施来深入检查模型，就像XAI一样。此外，没有办法获得对个别图像预测的某种可解释性或解释。结果，我不得不混淆部分输入图像并分析预测。通常，AutoML的可解释性和调试工具是一个特殊的问题。自动生成的模型往往非常复杂，因此很难分析。此外，在大多数情况下，复杂性会增加一倍，因为复杂的模型需要更多的时间来运行预测，而这反过来又会使使用黑盒分析工具获得解释变得更加繁琐。</p>







<h2 id="h-automl-vs-data-scientists">汽车与数据科学家</h2>



<p>在我给出一些数字之前，请记住，根据您试图解决的问题，您对AutoML的体验会有很大的不同。所以，让我们开始吧。</p>



<h3>关于AutoML基准的一句话</h3>



<p>关于AutoML基准测试的文献相当稀少，而且大多数时候都是比较AutoML解决方案的性能，而忽略了人的性能。此外，这些研究大多是关于表格数据集。幸运的是，我们在建立标准化的方法来评估不同AutoML解决方案的性能方面做了一些工作。</p>



<p>首先是<a href="https://web.archive.org/web/20221201161809/https://github.com/openml/automlbenchmark" target="_blank" rel="noreferrer noopener nofollow"> AutoML基准</a>，然后还有一个所谓的Kaggle基准，你可以在本文和<a href="https://web.archive.org/web/20221201161809/https://towardsdatascience.com/compare-popular-automl-frameworks-on-10-tabular-kaggle-competitions-9b1420e8942d" target="_blank" rel="noreferrer noopener nofollow">这篇中等文章</a>中找到<a href="https://web.archive.org/web/20221201161809/https://arxiv.org/pdf/2003.06505.pdf" target="_blank" rel="noreferrer noopener nofollow">的例子。关于在计算机视觉和文本分类任务中使用AutoML/NAS的信息，最简单的方法是检查</a><a href="https://web.archive.org/web/20221201161809/https://github.com/google-research/nasbench" target="_blank" rel="noreferrer noopener nofollow"> NAS Bench </a> (mark)和<a href="https://web.archive.org/web/20221201161809/https://www.automl.org/nas-overview/" target="_blank" rel="noreferrer noopener nofollow">少数其他比赛</a>的结果。尽管如此，人们主导的设计和算法主导的设计之间没有太多的比较分析。</p>



<h3>所有的希望都失去了吗？</h3>



<p>不。一方面，你可以试着用上面提到的数据集运行你的模型，看看你对AutoML有多好/差。当然，这不是你想要的答案。输入<a href="https://web.archive.org/web/20221201161809/https://arxiv.org/abs/2108.12193" target="_blank" rel="noreferrer noopener nofollow"> <em>“人对机器:AutoML和人类专家在网络钓鱼检测中的作用”</em> </a>。我给你讲讲它的要点，还有一点个人意见。</p>



<figure class="wp-block-image is-resized"><img decoding="async" loading="lazy" src="../Images/a9f7834455e18f441ed9cbedc75ad5e3.png" alt="" data-original-src="https://web.archive.org/web/20221201161809im_/https://lh3.googleusercontent.com/Rku7Vvb3Qh1CrXtThd9shJiVG0xrXdAUBwieQWqOsMf2t2niq_XgaoWe3LSvqgZ_pCzFB_kW-AlnbXw6dg4iz08C1rRZhxsIuevvGcF3QSdig_3z1K-AzfgxidKTc8DidL0I28dRxadh0OV9PQ"/><figcaption><em>Comparisons of the AUC score and training duration of the best model built using AutoML and non-AutoML frameworks* | See the <a href="https://web.archive.org/web/20221201161809/https://arxiv.org/pdf/2108.12193.pdf" target="_blank" rel="noreferrer noopener nofollow">article</a> for more details </em></figcaption></figure>



<p><em> *需要注意的一点是——持续时间是根据模型在给定数据集上接受训练所需的时间来计算的。</em></p>



<ul><li>作者得出结论，当应用这些解决方案的数据集在它们的类中有一些重叠时，AutoML模型明显优于人，并且通常显示高度的非线性。换句话说，硬数据集。否则，性能相当于不使用AutoML。他们还声称，与非AutoML相比，AutoML解决方案通常需要更长的时间来创建高性能的模型。</li></ul>



<ul><li>这里有一个问题，作者没有提到提出一个高性能模型所需要的时间。为什么你会问？因为对于他们的非AutoML解决方案，他们采用现有的scikit-learn算法，根本不调整它们。这一切意味着什么？首先，对持续时间的结论要有所保留。其次，AutoML只对有噪声、重叠类和高度非线性的硬数据集有意义。否则，您最好使用一些现成算法的默认设置。</li></ul>



<p>他们对数据集复杂性和AutoML优势之间的相关性的发现与我的个人经验和AutoML基准测试的结果非常一致，在更复杂的数据集上，一些AutoML解决方案在AUC和准确性方面比手动创建的模型有10%以上的优势。你可能还记得我在AutoML cons第一部分的故事，我花了几个月的工作，谷歌的AutoML几乎在24小时内匹配。</p>



<p>所有这些信息对你有什么帮助？如果你知道你的数据集是行为良好的，也许不要用AutoML。但是你怎么知道？您可以尝试运行几个经典的ML模型，看看它们的交叉验证性能如何变化。或者只是“看看”你的数据。</p>



<p>就我个人而言，我首先使用AutoML作为快速探索工具，然后当所有希望都破灭时。从不介于两者之间。为了帮助你对AutoML做出自己的决定，请查看下面的链接，并进行实验。</p>



<p><strong>进一步阅读AutoML方法的基准，包括针对人类的基准:</strong></p>







<h2 id="h-what-if-everyone-would-use-automl-always">如果…每个人都一直使用AutoML会怎么样？</h2>



<p>在我们深入这个思想实验之前，回想一下AutoML是通过用计算换取专业知识来工作的。如果我们一无所知，却拥有巨大的计算能力，这就是“工具”。让我们分析一下，如果我们在一家更经典、更成熟的企业和一家创新型公司中全力以赴，会发生什么。</p>



<h3>像福特这样的大企业</h3>



<p>根据哪个部门将使用AutoML而不是他们现有的ML/DS工具，我们可能会有一些好的结果，例如在市场营销和销售方面，有些坏的结果在物流和规划方面，可能绝对是垃圾结果，如ADAS，这是高级驾驶辅助系统和模拟软件。此外，公司运行这些AutoML解决方案所需的计算能力的增加肯定会使他们花费一大笔钱。</p>



<p>即使他们有钱和不理性地在AutoML上全押，这仍然是一个坏主意，因为对模型可解释性的严格要求，这是AutoML产生的复杂集合模型所不能提供的。很难通过。</p>



<h3>像Palantir这样的创新公司</h3>



<p>如果我们具体谈论Palantir，我相信无论有没有AutoML，他们的软件都不会真的关心，因为它是关于集成和智能地使用一个组织的数据资产。尽管如此，大多数分析并不需要非常先进的ML算法，所以使用AutoML将是浪费金钱。当最佳模型仍然是线性回归或决策树时，为什么要使用它。为什么你会问？因为他们的客户是非常重视模型可解释性的组织。</p>



<p>对于任何其他创新公司来说，AutoML都有自己的位置，但仍有一些严重的限制。很多时候，这些组织面临的问题不能简单地用监督分类或回归来描述，这使得使用AutoML变得很棘手。</p>



<p>用例越创新，就越难使用现成的解决方案。你能想象使用开源的AutoML工具来开发新药、复合材料，或者优化专用芯片上的晶体管布局吗？我也没有。这些任务很容易也应该被当作研究方向。有人需要创业想法吗？</p>



<h3>分析</h3>



<p>也许你已经注意到，行业采用AutoML的一个主要问题是可解释性。你可能会认为<em>“哦，但也许他们没有听说过像</em><a href="https://web.archive.org/web/20221201161809/https://shap.readthedocs.io/en/latest/index.html" target="_blank" rel="noreferrer noopener nofollow"><em/></a><em>，或XAI(可解释的人工智能)这样的东西？那应该会改变他们的想法。我向你保证，不会的。反正不会很快。</em></p>



<p>你看，模型的可解释性和可解释性之间有很大的区别。前者意味着模型可以被理解，因为它是。后者通常意味着有一种方法可以推断出为什么会做出某种预测，或者在更学术/前沿的情况下，模型会“告诉你”其预测背后的推理。也许你已经看到了这里的问题。没有人能向你保证这个解释是正确的。</p>



<p>这就是为什么，例如，有成千上万的人开发基于神经网络的计算机视觉模型，根据他们的X射线扫描来检测患者是否患有COVID，但没有任何主要的医疗机构使用这些模型。医生需要很好地理解为什么做出这些预测。与法律、会计、销售、市场营销和所有其他部门一样，对模型可解释性有不同的、有时是不可协商的需求。这就是为什么组织仍然热衷于线性模型和决策树，而回避密集的神经网络。</p>



<h2 id="h-so-what-would-be-a-good-use-case-for-automl">那么什么是AutoML的好用例呢？</h2>



<p>现在，让我们看一些可以从AutoML中获益最多的具体用例:</p>



<h3>批处理作业</h3>



<p>大多数AutoML工具没有考虑模型的复杂性/计算需求，结果给你非常好的模型，这可能是非常慢或计算要求高的。因此，在交互式或流式场景中使用这样的模型是不可能的，所以剩下的就是使用它们进行批处理作业。</p>



<p>也许将ML作为批处理作业运行听起来并不令人兴奋，尤其是在您阅读了部署ML模型与用户直接交互的令人难以置信的工程技术，甚至可能在边缘设备上，或者人们如何在流场景中使用ML模型以近乎实时的方式处理数十亿个事件之后，但是请相信我，许多企业的流程完全可以按照计划在几个小时、几天甚至几周内运行一次。你肯定听说过，在商业领域，最快的结果胜过最准确的结果，但是在很多情况下，准确性比时间更重要。</p>



<h3>测试水的问题</h3>



<p>我以前说过，现在我要再说一遍——AutoML最适合快速原型开发。这是我最喜欢的AutoML用例，它可以帮助我评估性能的上限，以及我当前的数据集和预处理/特征工程。当你采用这种思维模式时，你会慢慢转向一个更加以数据为中心的ML/AI范式，因为你只是假设你总是会得到一个优化的模型。</p>



<p>请记住，这应该在EDA阶段的之后的<strong>完成。此外，如果可能的话，根据你的EDA，尽量减少搜索空间。如果属性和目标变量之间没有显著的相关性，您可以放心地从搜索空间中删除线性分类器。我喜欢做的是使用AutoML工具在缩小的搜索空间内运行一些快速实验，只使用最简单的模型，由于可复制性，使用不同的随机种子，看看哪些是性能最好的模型。基于此，我可以为下一轮调整搜索空间。</strong></p>



<h2 id="h-takeaways">外卖食品</h2>



<p>AutoML是福也是祸。就像任何工具一样，它可以被正确使用以获得最大的利益，也可以被滥用，然后说坏话。</p>



<blockquote class="wp-block-quote"><p>要记住的一点是<strong>不要滥用它</strong>。</p></blockquote>



<p>甚至在分析您的数据或理解您的问题之前，在任何问题上抛出AutoML都是诱人的。不要成为那样的人。</p>



<p>你应该从这篇博客文章中得到的另一件重要的事情是:<em>将你使用AutoML节省的所有时间投资在特性工程上</em>。你可以这样想，如果你的数据集有最好的模型，你还能做些什么来提高你的机器学习系统的性能呢？显然，您可以获取更多的数据，或者确保数据具有更高的质量或更丰富的特性。当然，AutoML不会给你一个完美的模型，但基本原理是成立的。随着建模(几乎)的完成，更好的性能仍然是可能的，您应该专注于改进您的数据和特性以达到那些性能目标。如果结果看起来太好——调试它。</p>



<p>最重要的是，确保你非常了解业务需求。因此，在强大的CPU和GPU上运行AutoML几个小时之前，花几分钟时间讨论一下您的用户是否会欣赏预测性能的轻微提高，并且不会介意模型可解释性的缺乏。</p>



<p>如您所见，根据您询问的对象，AutoML可以有完全不同的含义。我记得我第一次发现AutoML销售的大部分产品都可以通过多核工作站、超参数优化库来完成，并且所有这些都包装在一个简单的用户界面中时，我有些失望。只要对你有用，我想。</p>



<h3>参考</h3>




        </div>
        
    </div>    
</body>
</html>