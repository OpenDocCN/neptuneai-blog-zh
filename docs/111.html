<html>
<head>
<title>Self-Driving Cars With Convolutional Neural Networks (CNN) </title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>带有卷积神经网络(CNN)的自动驾驶汽车</h1>
<blockquote>原文：<a href="https://web.archive.org/web/https://neptune.ai/blog/self-driving-cars-with-convolutional-neural-networks-cnn#0001-01-01">https://web.archive.org/web/https://neptune.ai/blog/self-driving-cars-with-convolutional-neural-networks-cnn#0001-01-01</a></blockquote><div><div class="l-content content-wrapper js-content">
            
<p>人类等待自动驾驶汽车已经几十年了。由于技术的飞速发展，这个想法最近从“可能”变成了“在特斯拉汽车上实现商业化”。</p>



<p>深度学习是实现自动驾驶的主要技术之一。这是一个多功能的工具，几乎可以解决任何问题——它可以用于物理学，例如，大型强子对撞机中的<a href="https://web.archive.org/web/20221201175445/https://arxiv.org/pdf/2006.10159.pdf" target="_blank" rel="noreferrer noopener nofollow">质子-质子碰撞</a>，以及在<a href="https://web.archive.org/web/20221201175445/https://lens.google/">谷歌镜头</a>中对图片进行分类。深度学习是一种可以帮助解决几乎任何类型的科学或工程问题的技术。</p>



<p>在本文中，我们将重点关注自动驾驶汽车中的深度学习算法——<strong>卷积神经网络</strong> (CNN)。CNN是这些系统用来识别和分类道路的不同部分并做出适当决定的主要算法。</p>



<p>在这个过程中，我们将看到特斯拉、Waymo和英伟达如何使用CNN算法来使他们的汽车无人驾驶或自动驾驶。</p>



<h2 id="how-does-it-work">自动驾驶汽车是如何工作的？</h2>



<p>第一辆自动驾驶汽车发明于1989年，它是神经网络 (ALVINN)中的<strong>自动陆地车辆。它使用神经网络来检测线路，分割环境，自我导航和驾驶。它工作得很好，但是受到处理能力慢和数据不足的限制。</strong></p>



<p>如今的高性能显卡、处理器、海量数据，自驾比以往任何时候都强大。如果成为主流，将减少交通拥堵，增加道路安全。</p>



<p>自动驾驶汽车是自主决策系统。它们可以处理来自相机、激光雷达、雷达、GPS或惯性传感器等不同传感器的数据流。然后，使用深度学习算法对这些数据进行建模，然后做出与汽车所处环境相关的决策。</p>


<div class="wp-block-image">
<figure class="aligncenter size-large is-resized"><img decoding="async" src="../Images/06cff7071273dd03c19030b1c5a6d651.png" alt="Self driving cars - pipeline" class="wp-image-50843" data-recalc-dims="1" data-original-src="https://web.archive.org/web/20221201175445im_/https://i0.wp.com/neptune.ai/wp-content/uploads/2022/10/Self-driving-cars-pipeline.png?resize=849%2C276&amp;ssl=1"/><figcaption class="wp-element-caption"><em> A modular perception-planning-action pipeline |  <a href="https://web.archive.org/web/20221201175445/https://arxiv.org/pdf/1910.07738.pdf" target="_blank" rel="noreferrer noopener nofollow">Source</a></em></figcaption></figure></div>


<p>上图显示了用于做出驾驶决策的模块化<strong>感知-规划-行动</strong>管道。这种方法的关键部分是从环境中获取数据的不同传感器。</p>



<p>为了理解自动驾驶汽车的工作原理，我们需要考察四个主要部分:</p>



<ol>
<li><strong>感知</strong></li>



<li><strong>本地化</strong></li>



<li><strong>预测</strong></li>



<li><strong>决策制定</strong><ol>
<li>高级路径规划</li>



<li>行为仲裁</li>



<li>运动控制器</li>
</ol>
</li>
</ol>



<h3 id="perception">感觉</h3>



<p>自动驾驶汽车必须具备的最重要的属性之一是<strong>感知</strong>，它帮助汽车看到周围的世界，以及识别和分类它看到的东西。为了做出好的决策，汽车需要即时识别物体。</p>



<p>因此，汽车需要看到并分类红绿灯、行人、路标、人行道、停车点、车道等等。不仅如此，它还需要知道自己和周围物体的确切距离。感知不仅仅是看到和分类，它使系统能够评估距离，并决定减速或刹车。</p>



<p>为了实现如此高水平的感知，自动驾驶汽车必须有三个传感器:</p>



<ol>
<li>照相机</li>



<li>激光雷达</li>



<li>雷达</li>
</ol>



<h4>照相机</h4>



<p>摄像机为汽车提供视觉，实现多种任务，如<strong>分类、分割、</strong>和<strong>定位</strong>。相机需要高分辨率，并准确地呈现环境。</p>



<p>为了确保汽车接收到来自各个方向的视觉信息:前、后、左、右，摄像头被缝合在一起，以获得整个环境的360度视图。这些相机提供远至200米的宽视野，以及更集中感知的短视野。</p>


<div class="wp-block-image">
<figure class="aligncenter size-large"><img decoding="async" src="../Images/a7ae204dce530ef0460a399ce67e0390.png" alt="Self driving cars - camera" class="wp-image-50844" data-recalc-dims="1" data-original-src="https://web.archive.org/web/20221201175445im_/https://i0.wp.com/neptune.ai/wp-content/uploads/2022/10/Self-driving-cars-camera.png?ssl=1"/><figcaption class="wp-element-caption"><em>Self-driving car’s camera | <a href="https://web.archive.org/web/20221201175445/https://heartbeat.fritz.ai/computer-vision-at-tesla-cd5e88074376" target="_blank" rel="noreferrer noopener nofollow">Source</a></em></figcaption></figure></div>


<p>在一些像停车这样的任务中，摄像头还可以提供全景视图，以便更好地做出决策。</p>



<p>尽管相机完成所有与感知相关的任务，但在极端条件下，如雾、大雨，尤其是晚上，它几乎没有任何用处。在极端条件下，摄像机捕捉到的只是噪音和差异，这可能会危及生命。</p>



<p>为了克服这些限制，我们需要既能在没有光线的情况下工作又能测量距离的传感器。</p>



<h4>激光雷达</h4>



<p>激光雷达代表光探测和测距，这是一种通过发射激光束，然后测量它被某物反射所需时间来测量物体距离的方法。</p>



<p>摄像机只能给汽车提供它周围的图像。当它与激光雷达传感器结合时，它可以增加图像的深度——它突然对汽车周围的情况有了3D感知。</p>



<p>所以，激光雷达感知<strong>空间信息</strong>。当这些数据被输入深度神经网络时，汽车可以预测靠近它的物体或车辆的行动。这种技术在复杂的驾驶场景中非常有用，比如在多出口的十字路口，汽车可以分析所有其他汽车，并做出适当、最安全的决定。</p>



<figure class="wp-block-video aligncenter"><video autoplay="" controls="" loop="" muted="" src="https://web.archive.org/web/20221201175445im_/https://neptune.ai/wp-content/uploads/2022/11/Self-driving-car-LiDAR.mp4" playsinline=""/><figcaption class="wp-element-caption"><em>Object detection with LiDAR | <a href="https://web.archive.org/web/20221201175445/https://shangzhouye.tech/other-projects/deeplidar_detection_tracking/" target="_blank" rel="noreferrer noopener nofollow">Source</a></em></figcaption></figure>



<p>2019年，埃隆·马斯克公开表示“<a href="https://web.archive.org/web/20221201175445/https://www.youtube.com/watch?v=HM23sjhtk4Q" target="_blank" rel="noreferrer noopener nofollow">任何依赖激光雷达的人都注定……</a>”。为什么？好吧，激光雷达有可能是灾难性的局限性。例如，激光雷达传感器使用激光或光线来测量附近物体的距离。它可以在晚上和黑暗的环境中工作，但当有雨或雾的噪音时，它仍然会失败。这就是为什么我们还需要一个雷达传感器。</p>



<h4>receivable accounts data-entry and retrieval system 可接受的账目数据登录及修复系统</h4>



<p>无线电探测和测距(雷达)是许多军事和消费应用中的关键组件。它首先被军方用来探测物体。它使用<strong>无线电波信号</strong>计算距离。今天，它被用于许多车辆，并已成为自动驾驶汽车的主要组成部分。</p>



<p>雷达非常有效，因为它们使用无线电波而不是激光，所以它们在任何条件下都可以工作。</p>





<p>重要的是要明白雷达是噪声传感器。这意味着即使摄像头没有看到障碍物，雷达也会探测到一些障碍物。</p>





<p>上图显示了自动驾驶汽车(绿色)使用激光雷达检测周围的物体，并计算物体的距离和形状。对比同样的场景，但是用下面的雷达传感器捕捉到的，可以看到很多不必要的噪点。</p>





<p>为了做出好的决策和预测，应该对雷达数据进行清理。我们需要把弱信号和强信号分开；这被称为<strong>阈值</strong>。我们还使用<strong>快速傅立叶变换</strong> (FFT)来过滤和解释信号。</p>



<p>如果你看上面的下图，你会注意到雷达和激光雷达信号是基于点的数据。应该对这些数据进行分类，以便更好地解释。诸如<strong>欧几里德聚类</strong>或K均值聚类之类的聚类算法被用于实现这一任务。</p>





<h3 id="localization">本地化</h3>



<p>自动驾驶汽车中的定位算法计算车辆导航时的位置和方向，这种科学称为视觉里程计(VO)。</p>



<p>VO通过匹配连续视频帧中的关键点来工作。对于每一帧，关键点被用作映射算法的输入。映射算法，例如同步定位和映射(SLAM)，计算附近每个对象相对于前一帧的位置和方向，并帮助对道路、行人和周围的其他对象进行分类。</p>





<p>深度学习一般用于提高VO的性能，对不同的对象进行分类。诸如PoseNet和VLocNet++的神经网络是使用点数据来估计3D位置和方向的一些框架。这些估计的3D位置和方向可用于推导场景语义，如下图所示。</p>





<h3 id="prediction">预言；预测；预告</h3>



<p>理解人类司机是一项非常复杂的任务。它涉及情感而非逻辑，这些都是由<strong>反应</strong>推动的。附近的司机或行人的下一步行动变得非常不确定，因此可以预测其他道路使用者的行动的系统对于道路安全非常重要。</p>



<p>这款汽车拥有360度的环境视角，能够感知和捕捉所有信息并进行处理。一旦输入到深度学习算法中，它就可以提出其他道路使用者可能做出的所有可能的举动。这就像一个游戏，玩家有有限的移动次数，并试图找到最好的移动来击败对手。</p>



<p>自动驾驶汽车中的传感器使它们能够执行图像分类、物体检测、分割和定位等任务。通过各种形式的数据表示，汽车可以预测周围的物体。</p>



<p>深度学习算法可以在训练过程中对这些信息(来自激光雷达和雷达的图像和云数据点)进行建模。同样的模型，但在推理过程中，可以帮助汽车为所有可能的动作做准备，包括刹车、停止、减速、变道等等。</p>



<p>深度学习的作用是解释复杂的视觉任务，在环境中定位自己，增强感知，并在自动驾驶汽车中启动运动学机动。这确保了道路安全和方便通勤。</p>



<p>但是棘手的部分是从有限的动作中选择正确的动作。</p>



<h3 id="decision-making">决策</h3>



<p>决策在自动驾驶汽车中至关重要。他们需要一个在不确定环境中动态精确的系统。它需要考虑到，并非所有的传感器读数都是真实的，人类在驾驶时可能会做出不可预测的选择。这些东西是无法直接衡量的。即使我们可以测量它们，我们也不能准确地预测它们。</p>


<div class="wp-block-image">
<figure class="aligncenter size-large"><img decoding="async" src="../Images/b376bcb19d455fb49db1f613f90fbadb.png" alt="Self driving cars - decision making" class="wp-image-50857" data-recalc-dims="1" data-original-src="https://web.archive.org/web/20221201175445im_/https://i0.wp.com/neptune.ai/wp-content/uploads/2022/10/Self-driving-cars-decision-making.png?ssl=1"/><figcaption class="wp-element-caption"><em> A self-driving car moving towards an intersection | <a href="https://web.archive.org/web/20221201175445/https://ieeexplore.ieee.org/document/7995949" target="_blank" rel="noreferrer noopener nofollow">Source</a></em></figcaption></figure></div>


<p>上图显示了一辆自动驾驶汽车正在向一个十字路口行驶。另一辆蓝色的车也向十字路口开去。在这种情况下，自动驾驶汽车必须预测另一辆汽车是直行、左转还是右转。在每种情况下，汽车必须决定应该采取什么样的策略来避免碰撞。</p>



<p>为了做出决定，汽车应该有足够的信息，以便它可以选择必要的行动。我们了解到，传感器可以帮助汽车收集信息，深度学习算法可以用于定位和预测。</p>



<p>概括地说，定位使汽车能够知道它的初始位置，而预测则根据环境创造出<em> n </em>个可能的行动或移动。问题是:在众多预测的行动中，哪一个选择是最好的？</p>



<p>在做决策时，我们使用深度强化学习(DRL)。更具体地说，一种被称为<strong>马尔可夫决策过程</strong> (MDP)的决策算法位于DRL的核心(我们将在后面讨论强化学习的部分了解更多关于MDP的知识)。</p>



<p>通常，MDP用于预测道路使用者的未来行为。我们应该记住，如果对象的数量增加，尤其是移动的对象，场景会变得非常复杂。这最终增加了自动驾驶汽车本身可能的移动次数。</p>



<p>为了解决为自己找到最佳移动的问题，深度学习模型使用<strong>贝叶斯优化</strong>进行优化。也有这样的情况，由隐马尔可夫模型和贝叶斯优化组成的框架被用于决策。</p>



<p>一般来说，自动驾驶汽车中的决策是一个分层的过程。这个过程有四个组成部分:</p>



<ul>
<li><strong>路径或路线规划</strong>:从本质上讲，路线规划是汽车必须做出的四个决定中的第一个。进入环境，汽车应该计划从其当前位置到请求的目的地的最佳可能路线。想法是在所有其他解决方案中找到一个最佳解决方案。</li>



<li><strong>行为仲裁</strong>:一旦规划好路线，汽车需要在路线中自行导航。汽车知道静态元素，如道路、十字路口、平均道路拥堵等，但它无法确切知道其他道路使用者在整个旅程中会做什么。其他道路使用者行为中的这种不确定性通过使用像MDPs这样的概率规划算法来解决。</li>



<li><strong>运动规划</strong>:一旦行为层决定如何导航通过某条路线，运动规划系统就会协调汽车的运动。轿厢的运动对于乘客来说必须是可行和舒适的。运动规划包括车速、变道等等，所有这些都应该与汽车所处的环境相关。</li>



<li><strong>车辆控制</strong>:车辆控制用于执行运动规划系统的参考路径。</li>
</ul>





<h2 id="cnn">用于自动驾驶汽车的CNN</h2>



<p>卷积神经网络(CNN)用于模拟空间信息，如图像。CNN非常擅长从图像中提取特征，它们通常被视为通用的非线性函数逼近器。</p>



<p>随着网络深度的增加，CNN可以捕捉到不同的模式。例如，网络起始处的图层将捕捉边，而深层图层将捕捉更复杂的要素，如对象的形状(树上的叶子或车辆上的轮胎)。这也是CNN在自动驾驶汽车中作为主要算法的原因。</p>



<p>CNN的关键部分是卷积层本身。它有一个卷积内核，通常称为<em>滤波器矩阵</em>。滤波器矩阵与输入图像的局部区域进行卷积，该局部区域可以定义为:</p>





<p>其中:</p>



<ul>
<li>运算符*表示卷积运算，</li>



<li>w是滤波器矩阵，b是偏置，</li>



<li>x是输入，</li>



<li>y是输出。</li>
</ul>



<p>实际中滤波器矩阵的尺寸通常是3×3或5×5。在训练过程中，过滤器矩阵会不断更新自己，以获得合理的权重。CNN的属性之一就是权重是可共享的。相同的权重参数可以用于表示网络中的两种不同的变换。共享参数节省了大量的处理空间；它们可以产生由网络学习的更多样的特征表示。</p>



<p>CNN的输出通常被馈送到非线性激活函数。激活函数使网络能够解决线性不可分问题，这些函数可以在低维流形中表示高维流形。常用的激活函数有Sigmoid、Tanh和ReLU，如下所示:</p>





<p>值得一提的是，ReLU是首选的激活函数，因为它比其他激活函数收敛得更快。除此之外，卷积层的输出由max-pooling层修改，max-pooling层保留关于输入图像的更多信息，如背景和纹理。</p>



<p>CNN的三个重要属性使它们变得多才多艺，成为自动驾驶汽车的主要组成部分，这三个属性是:</p>



<ul>
<li><strong>局部感受野，</strong></li>



<li><strong>共享权重，</strong></li>



<li><strong>空间采样</strong>。</li>
</ul>



<p>这些属性减少了过度拟合，并存储了对图像分类、分割、定位等至关重要的表示和特征。</p>





<p>接下来，我们将讨论开创无人驾驶汽车的三家公司使用的三个CNN网络:</p>



<ol>
<li>特斯拉的HydraNet</li>



<li>谷歌Waymo的司机网</li>



<li>英伟达自动驾驶汽车</li>
</ol>



<h3 id="hydranet">HydraNet——自动驾驶汽车的语义分段</h3>



<p>HydraNet由<a href="https://web.archive.org/web/20221201175445/https://rmullapudi.bitbucket.io/data/hydranet_cvpr_final.pdf?utm_source=Jeremy+Cohen&amp;utm_campaign=15c163eaa1-EMAIL_CAMPAIGN_2020_07_10_08_05&amp;utm_medium=email&amp;utm_term=0_9a0160b0e8-15c163eaa1-" target="_blank" rel="noreferrer noopener nofollow"> Ravi等人于2018年</a>推出。它是为语义分割开发的，用于提高推理时的计算效率。</p>





<p>HydraNets是动态架构，所以它可以有不同的CNN网络，每个分配给不同的任务。这些块或网络被称为分支。HydraNet的想法是获取各种输入，并将其输入到特定任务的CNN网络中。</p>



<p>以自动驾驶汽车为例。一个输入数据集可以是静态环境，如树木和道路栏杆，另一个可以是道路和车道，另一个是交通灯和道路，等等。这些输入在不同的分支中被训练。在推理时间内，<strong>门</strong>选择运行哪些分支，合并器汇总分支输出并做出最终决定。</p>



<p>在特斯拉的例子中，他们稍微修改了这个网络，因为在推理过程中很难分离各个任务的数据。为了克服这个问题，特斯拉的工程师开发了一种共享主干网。共享主干通常是经过修改的ResNet-50块。</p>



<p>这个HydraNet是在所有对象的数据上训练的。有特定于任务的标题，允许模型预测特定于任务的输出。标题基于语义分段架构，如U-Net。</p>





<p>特斯拉HydraNet还可以投影鸟瞰图，这意味着它可以从任何角度创建环境的3D视图，为汽车提供更多维度来正确导航。要知道特斯拉并没有使用激光雷达传感器。它只有两个传感器，一个摄像头和一个雷达。虽然激光雷达明确地为汽车创造了深度感知，但特斯拉的hydranet非常高效，它可以将其中8个摄像头的所有视觉信息缝合起来，创造深度感知。</p>





<h3 id="chauffeurnet">司机网:利用模仿学习训练自动驾驶汽车</h3>



<p><a href="https://web.archive.org/web/20221201175445/http://roboticsproceedings.org/rss15/p31.pdf" target="_blank" rel="noreferrer noopener">司机网</a>是谷歌Waymo使用的一个基于RNN的神经网络，然而，CNN实际上是这里的核心组件之一，它用于从感知系统中提取特征。</p>



<p>司机网络中的CNN被描述为卷积特征网络，或特征网络，其提取由其他网络共享的上下文特征表示。然后，这些表示被输入到递归代理网络(AgentRNN ),该网络反复产生驾驶轨迹中连续点的预测。</p>



<p>这个网络背后的想法是使用模仿学习来训练自动驾驶汽车。在Bansal等人发布的论文《<a href="https://web.archive.org/web/20221201175445/https://arxiv.org/abs/1812.03079" target="_blank" rel="noreferrer noopener nofollow">司机网:通过模仿最好的，综合最差的</a>来学习驾驶》中，他们认为，即使有3000万个例子，训练一辆自动驾驶汽车也是不够的。为了解决这一限制，作者在合成数据中训练了汽车。这种合成数据引入了偏差，例如对轨迹路径引入扰动、添加障碍物、引入不自然的场景等。他们发现，这样的合成数据能够比正常数据更有效地训练汽车。</p>



<p>通常，自驾车有一个端到端的过程，正如我们前面看到的那样，感知系统是深度学习算法的一部分，与规划和控制一起。在司机网的情况下，感知系统不是端到端过程的一部分；相反，它是一个中级系统，其中网络可以有来自感知系统的不同变化的输入。</p>





<p>drick net通过观察来自传感器的场景的中级表示来产生驾驶轨迹，使用输入和合成数据来模仿专家驾驶员。</p>





<p><em>上图中，青色路径描绘的是输入路线，绿色方框是自动驾驶汽车，蓝色圆点是智能体过去的路线或位置，绿色圆点是预测的未来路线或位置。</em></p>



<p>从本质上来说，中级表示不直接使用原始传感器数据作为输入，排除了感知任务，因此我们可以将真实和模拟数据结合起来，以便于迁移学习。这样，网络可以创建环境的高层次鸟瞰图，最终产生更好的决策。</p>



<h3>英伟达自动驾驶汽车:自动驾驶汽车的极简主义方法</h3>



<p>英伟达也使用卷积神经网络作为其自动驾驶汽车的主要算法。但与特斯拉不同的是，它使用3个摄像头，一边一个，前面一个。见下图。</p>





<p>该网络能够在没有车道标志的道路上运行，包括停车场。它还可以学习检测有用道路特征所必需的特征和表示。</p>



<p>与问题的显式分解(如车道标志检测、路径规划和控制)相比，这种端到端系统同时优化了所有处理步骤。</p>



<p>更好的性能是内部组件自我优化以最大化整体系统性能的结果，而不是优化人工选择的中间标准，如车道检测。可以理解的是，选择这样的标准是为了便于人工解释，这并不能自动保证最大的系统性能。较小的网络是可能的，因为系统学习用最少的处理步骤来解决问题。</p>



<h2 id="rl">用于自动驾驶汽车的强化学习</h2>



<p><a href="/web/20221201175445/https://neptune.ai/blog/best-reinforcement-learning-tutorials-examples-projects-and-courses" target="_blank" rel="noreferrer noopener">强化学习</a> (RL)是一种机器学习的类型，其中代理通过探索和与环境交互来学习。在这种情况下，自动驾驶汽车是一个<strong>代理</strong>。</p>







<p>我们之前讨论了神经网络如何根据感知数据预测一些动作。但是，选择适当的行动需要深度强化学习(DRL)。在DRL的核心，我们有三个重要变量:</p>



<ol>
<li><strong>状态</strong>描述给定时间内的当前情况。在这种情况下，它将是道路上的一个位置。</li>



<li><strong>动作</strong>描述了汽车可能做出的所有动作。</li>



<li><strong>奖励</strong>是每当汽车采取某个动作时收到的反馈。</li>
</ol>



<p>通常，代理不会被告知要做什么或采取什么行动。到目前为止，我们已经看到，在监督学习中，算法将输入映射到输出。在DRL，算法通过探索环境来学习，每次互动都会产生一定的回报。回报可以是正面的，也可以是负面的。DRL的目标是最大化累积回报。</p>



<p>在自动驾驶汽车中，遵循相同的程序:网络根据感知数据进行训练，学习应该做出什么决定。因为CNN非常擅长从输入中提取表征的特征，所以DRL算法可以在这些表征上进行训练。在这些表示上训练DRL算法可以产生好的结果，因为这些提取的表示是高维流形到更简单的低维流形的转换。对较低表示的训练产生推理所需的效率。</p>



<p>需要记住的一个关键点是，自动驾驶汽车不能在现实世界的场景或道路中进行训练，因为它们将极其危险。相反，无人驾驶汽车在完全没有风险的模拟器上接受训练。</p>



<p>一些开源模拟器有:</p>



<ol>
<li><a href="https://web.archive.org/web/20221201175445/https://carla.org/" target="_blank" rel="noreferrer noopener nofollow">卡拉</a></li>



<li><a href="https://web.archive.org/web/20221201175445/https://github.com/AdaCompNUS/summit" target="_blank" rel="noreferrer noopener nofollow">峰会</a></li>



<li><a href="https://web.archive.org/web/20221201175445/https://microsoft.github.io/AirSim/" target="_blank" rel="noreferrer noopener nofollow"> AirSim </a></li>



<li><a href="https://web.archive.org/web/20221201175445/https://deepdrive.io/index.html" target="_blank" rel="noreferrer noopener nofollow"> DeepDrive </a></li>



<li><a href="https://web.archive.org/web/20221201175445/https://flow-project.github.io/" target="_blank" rel="noreferrer noopener nofollow">流量</a></li>
</ol>


<div class="wp-block-image">
<figure class="aligncenter size-large"><img decoding="async" src="../Images/ff556179a1e5e7299dec0f232871532d.png" alt="Self driving car simulator - deepdrive" class="wp-image-50868" data-recalc-dims="1" data-original-src="https://web.archive.org/web/20221201175445im_/https://i0.wp.com/neptune.ai/wp-content/uploads/2022/10/Self-driving-car-simulator-deepdrive.jpeg?ssl=1"/><figcaption class="wp-element-caption"><em>A snapshot from Voyage Deepdrive | <a href="https://web.archive.org/web/20221201175445/https://news.voyage.auto/introducing-voyage-deepdrive-69b3cf0f0be6" target="_blank" rel="noreferrer noopener nofollow">Source</a></em></figcaption></figure></div>

<div class="wp-block-image">
<figure class="aligncenter"><img decoding="async" src="../Images/9c610b0eeb6d04886cf9014cbd6cdb2c.png" alt="Voyage Deepdrive" data-original-src="https://web.archive.org/web/20221201175445im_/https://lh6.googleusercontent.com/eZDAcI6Bfrn3QazoM5XXzUZPBmUqCbReniwAsNjC2IOdYZK0VLUre_5pMq7yYFg4zp_0u15Zrf2vossJxJ76UlzfT3Iv8tw4SYkRmVeB97GQBCR1cwg0qsyLeyZEjLqzcLEa0S5Q"/><figcaption class="wp-element-caption"> <em>A snapshot from Voyage Deepdrive | <a href="https://web.archive.org/web/20221201175445/https://news.voyage.auto/introducing-voyage-deepdrive-69b3cf0f0be6" target="_blank" rel="noreferrer noopener nofollow">Source</a></em> </figcaption></figure></div>


<p>这些汽车(代理)在部署到现实世界之前，经过了数千次高难度模拟训练。</p>



<p>在训练过程中，智能体(汽车)通过在特定状态下采取特定动作来学习。基于这个<strong>状态-动作</strong>对，它接收一个<strong>奖励</strong>。这个过程反复发生。每次代理更新它的奖励记忆时。这就是所谓的T4政策。</p>



<p>策略被描述为代理如何做出决策。这是一个决策规则。该策略定义了代理在给定时间的行为。</p>



<p>代理人每做出一个否定的决定，政策就会改变。所以为了避免负面的回报，代理人会检查某个动作的质量。这是由<strong>状态值函数测量的。</strong>状态值可以用<strong>贝尔曼期望方程来度量。</strong></p>



<p>贝尔曼期望方程，连同马尔可夫决策过程(MDP)，构成了DRL的两个核心概念。但是当谈到自动驾驶汽车时，我们必须记住<strong>来自感知数据的观察应该与适当的动作</strong>相映射，而不仅仅是将底层状态映射到动作。这就是需要部分观察的决策过程或<strong>部分可观察马尔可夫决策过程(POMDP) </strong>的地方，它可以根据观察做出决策。</p>



<h2 id="reward">用于自动驾驶汽车的部分可观测马尔可夫决策过程</h2>



<p><a href="https://web.archive.org/web/20221201175445/https://neptune.ai/blog/markov-decision-process-in-reinforcement-learning">马尔可夫决策过程</a>给了我们一种将决策顺序化的方法。当代理与环境交互时，它会随时间顺序进行。每次代理与环境交互时，它都会给出环境状态的某种表示。给定状态的表示，代理选择要采取的动作，如下图所示。</p>





<p>所采取的动作被转换到某个新的状态，并且代理被给予奖励。这个评估状态、采取行动、改变状态、奖励的过程不断重复。在整个过程中，代理人的目标是最大化奖励总额。</p>



<p>让我们对整个过程有一个更有建设性的想法:</p>



<ol>
<li>在给定时间t，环境的状态为St</li>



<li>代理观察当前状态St，并在</li>



<li>然后，环境转换到新的状态St+1，同时代理被奖励Rt</li>
</ol>



<p>在<strong>部分可观察马尔可夫决策过程</strong> (POMDP)中，代理通过从感知数据接收的观察来感知环境状态，并采取特定的行动，然后接收奖励。</p>



<p>POMDP有六个分量，可以表示为POMDP <em> M:= (I，S，A，R，P，</em> γ)，其中，</p>



<ul>
<li>一:意见</li>



<li>状态的有限集合</li>



<li>答:有限的一组动作</li>



<li>r:奖励函数</li>



<li>p:转移概率函数</li>



<li>γ——未来奖励的折现系数。</li>
</ul>



<p>DRL的目标是找到期望的政策，在每个给定的时间步最大化回报，或者换句话说，找到一个最优的价值-行动函数(Q函数)。</p>



<h3 id="qlearning">用于自动驾驶汽车的Q-learning</h3>



<p><a href="https://web.archive.org/web/20221201175445/https://towardsdatascience.com/simple-reinforcement-learning-q-learning-fcddc4b6fe56" target="_blank" rel="noreferrer noopener nofollow"> Q-learning </a>是自动驾驶汽车最常用的DRL算法之一。它属于<strong>无模型学习</strong>的范畴。在无模型学习中，代理将试图逼近最优状态-动作对。<strong>策略</strong>仍然决定哪些动作值对或Q值被访问和更新(见下面的等式)。目标是通过与环境交互找到最佳策略，同时在代理出错时修改环境。</p>



<p>有了足够的样本或观测数据，Q-learning会学习到最优的状态-动作值对。在实践中，Q-learning已经被证明以概率1收敛到MDP的最佳状态-动作值，假设所有状态中的所有动作是无限可用的。</p>



<p>Q-learning可以用下面的等式来描述:</p>





<p>其中:</p>



<p>α ∈ [0，1]是学习率。它控制给定t下Q值的更新程度。</p>





<p>重要的是要记住，代理将通过反复试验发现好的和坏的行为。</p>



<h2 id="h-conclusion">结论</h2>



<p>自动驾驶汽车旨在通过提高安全性和效率来彻底改变汽车旅行。在本文中，我们概述了一些关键组件，如激光雷达、雷达、相机，以及最重要的是——使无人驾驶汽车成为可能的算法。</p>



<p>虽然很有希望，但仍有很大的改进空间。例如，目前的自动驾驶汽车处于第五级发展中的第二级，这意味着在必要时仍然需要有人随时干预。</p>



<p>需要注意的事情很少:</p>



<ol>
<li>所使用的算法还没有优化到足以感知道路和车道，因为一些道路缺乏标记和其他标志。</li>



<li>用于定位、绘图和感知的最佳感测模态仍然缺乏准确性和效率。</li>



<li>车对车通信仍然是一个梦想，但这方面的工作也正在进行。</li>



<li>人机交互领域的探索还不够，有很多开放的、未解决的问题。</li>
</ol>



<p>尽管如此，我们迄今为止开发的技术仍然令人惊叹。通过协调一致的努力，我们可以确保自动驾驶系统是安全、稳健和革命性的。</p>



<h3>延伸阅读:</h3>



<ol>
<li><a href="https://web.archive.org/web/20221201175445/https://arxiv.org/pdf/1910.07738.pdf" target="_blank" rel="noreferrer noopener nofollow">自动驾驶深度学习技术综述</a></li>



<li><a href="https://web.archive.org/web/20221201175445/https://arxiv.org/pdf/1906.05113.pdf" target="_blank" rel="noreferrer noopener nofollow">自动驾驶调查:常见实践和新兴技术</a></li>



<li><a href="https://web.archive.org/web/20221201175445/https://ieeexplore.ieee.org/document/7995949" target="_blank" rel="noreferrer noopener nofollow">考虑周围车辆相互作用和不确定预测的自动驾驶决策</a></li>



<li><a href="https://web.archive.org/web/20221201175445/https://iopscience.iop.org/article/10.1088/1742-6596/1869/1/012071/pdf" target="_blank" rel="noreferrer noopener nofollow">使用CNN深度学习算法的自动驾驶汽车</a></li>



<li><a href="https://web.archive.org/web/20221201175445/https://arxiv.org/pdf/2002.00444.pdf" target="_blank" rel="noreferrer noopener nofollow">自动驾驶的深度强化学习:综述</a></li>



<li><a href="https://web.archive.org/web/20221201175445/https://www.wired.com/story/guide-self-driving-cars/" target="_blank" rel="noreferrer noopener nofollow">自动驾驶汽车的有线指南</a></li>



<li><a href="https://web.archive.org/web/20221201175445/https://towardsdatascience.com/deep-learning-for-self-driving-cars-7f198ef4cfa2" target="_blank" rel="noreferrer noopener nofollow">自动驾驶汽车的深度学习</a></li>



<li><a href="https://web.archive.org/web/20221201175445/https://towardsdatascience.com/reinforcement-learning-towards-general-ai-1bd68256c72d" target="_blank" rel="noreferrer noopener nofollow">利用强化学习训练自动驾驶汽车</a></li>



<li><a href="https://web.archive.org/web/20221201175445/https://lilianweng.github.io/lil-log/2018/02/19/a-long-peek-into-reinforcement-learning.html" target="_blank" rel="noreferrer noopener nofollow">一(长)窥强化学习</a></li>
</ol>
        </div>
        
    </div>    
</body>
</html>