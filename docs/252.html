<html>
<head>
<title>Plotly Python Tutorial for Machine Learning Specialists </title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>面向机器学习专家的Plotly Python教程</h1>
<blockquote>原文：<a href="https://web.archive.org/web/https://neptune.ai/blog/plotly-python-tutorial-for-machine-learning-specialists#0001-01-01">https://web.archive.org/web/https://neptune.ai/blog/plotly-python-tutorial-for-machine-learning-specialists#0001-01-01</a></blockquote><div><div class="l-content content-wrapper js-content">
            
<p>Plotly是一个开源的Python图形库,非常适合构建漂亮的交互式可视化。在深入研究机器学习建模之前，它是发现数据集中模式的一个非常棒的工具。在本文中，我们将看看如何以示例驱动的方式使用它。</p>



<p>您可能会看到的一些可视化效果包括:</p>



<ul><li>线形图，</li><li>散点图，</li><li>条形图，</li><li>误差线，</li><li>箱线图，</li><li>直方图，</li><li>热图，</li><li>支线剧情，</li><li>和气泡图。</li></ul>







<h3>为什么你会选择Plotly</h3>



<p>现在，事实是你仍然可以使用Matplotlib、Seaborn或者T2的Bokeh来获得这些可视化效果。有几个原因可以解释为什么你会选择Plotly:</p>



<ul><li>可视化是交互式的，不像Seaborn和Matplotlib</li><li>使用Plotly的高级Express API生成复杂的视觉效果相当简单；</li><li>Plotly还提供了一个名为<a href="https://web.archive.org/web/20221206044847/https://plotly.com/dash/" target="_blank" rel="noreferrer noopener nofollow"> Plotly Dash </a>的框架，你可以用它来托管你的可视化以及机器学习项目；</li><li>你可以为你的可视化生成HTML代码，如果你喜欢，你可以把它嵌入到你的网站上。</li></ul>



<p>也就是说，生成可视化效果需要清理数据集。这是一个至关重要的部分，否则，你会有视觉传达错误的信息。在本文中，我们跳过清理和预处理部分，将重点放在可视化上。我们将在教程结束时提供整个笔记本。</p>



<p>创建可视化效果时，记住最佳实践也很重要，例如:</p>



<ul><li>使用对眼睛友好的颜色</li><li>确保数字相加，例如在饼图中，百分比总和应为100%</li><li>使用正确的色标，这样观众就能清楚地看到哪种颜色代表较高的数字，哪种颜色代表较低的数字</li><li>不要在同一个视图中放置太多的数据，例如，可以分组并绘制最上面的项目，而不是绘制数据集中的所有内容</li><li>保证剧情不要太忙</li><li>总是添加你的数据的来源，即使你是收集它的人。它建立信誉。</li></ul>



<p>我们可以通过两种方式与Plotly API进行交互；</p>







<p>在这篇文章中，我们将交替使用它们。</p>



<p id="separator-block_5fc68280c1e97" class="block-separator block-separator--5">Plotly直方图</p>



<h2 id="h-plotly-histogram">直方图是数字数据分布的表示，数据被分组到多个条块中。然后显示每个箱的计数。在Plotly中，可以使用sum或average等聚合函数来聚合数据。在绘图中，要入库的数据也可以是分类的。这里有一个例子:</h2>



<p>Plotly条形图</p>



<pre class="hljs"><span class="hljs-keyword">import</span> plotly.express <span class="hljs-keyword">as</span> px
fig = px.histogram(views, x=<span class="hljs-string">"views"</span>)
fig.show()</pre>







<p id="separator-block_5fc68286c1e98" class="block-separator block-separator--5">当您想要显示分类列和数字列时，条形图是一种很好的可视化工具。它显示了每个类别中某个数字列的数量。Plotly Express使绘制一个非常容易。</p>



<h2 id="h-plotly-bar-chart">你不仅仅局限于垂直条形图，你也可以使用水平条形图。这是通过定义“方向”来实现的。</h2>



<p>Plotly饼图</p>



<pre class="hljs">fig = px.bar(views_top, x=<span class="hljs-string">'event'</span>, y=<span class="hljs-string">'views'</span>)
fig.show()</pre>







<p>饼图是显示每个类别中项目数量的另一种可视化类型。这种类型使用户能够快速确定特定项或值在整个数据集中所占的份额。这次让我们展示一下如何使用Plotly的Graph对象来绘制。</p>



<pre class="hljs">fig = px.bar(views_top, x=<span class="hljs-string">'views'</span>, y=<span class="hljs-string">'event'</span>,orientation=<span class="hljs-string">'h'</span>)
fig.show()
</pre>







<p id="separator-block_5fc6828bc1e99" class="block-separator block-separator--5">Plotly圆环图</p>



<h2 id="h-plotly-pie-chart">您可以通过指定<code>hole</code>参数将上面的视觉效果更改为圆环图。这是您希望环形图上的孔的大小。</h2>



<p>Plotly散点图</p>



<pre class="hljs"><span class="hljs-keyword">import</span> plotly.graph_objects <span class="hljs-keyword">as</span> go

fig = go.Figure(
    data=[
        go.Pie(labels=labels, values=values)
    ])
fig.show()</pre>







<p id="separator-block_5fc6828fc1e9a" class="block-separator block-separator--5">散点图对于确定两个数值变量之间是否存在关系或相关性非常有用。</p>



<h2 id="h-plotly-donut-chart">Plotly线图</h2>



<p>折线图主要用于显示某一数值如何随时间或某一区间变化。</p>



<pre class="hljs">fig = go.Figure(
    data=[
        go.Pie(labels=labels, values=values, hole=<span class="hljs-number">0.2</span>)
    ])
fig.show()
</pre>







<p id="separator-block_5fc68295c1e9b" class="block-separator block-separator--5">Plotly注释</p>



<h2 id="h-plotly-scatter-plot">在Plotly中添加文本标签和注释非常简单。在散点图中，这可以通过指定<code>text</code>参数来实现。</h2>



<p>Plotly 3D散点图</p>



<pre class="hljs">fig = px.scatter(df,x=<span class="hljs-string">'comments'</span>,y=<span class="hljs-string">'views'</span>)
fig.show()
</pre>







<p id="separator-block_5fc68299c1e9c" class="block-separator block-separator--5">在Plotly中，可以通过传递x、y和z参数来创建3D散点图。</p>



<h2 id="h-plotly-line-chart">Plotly写入HTML</h2>



<p>Plotly还允许您将任何可视化保存到HTML文件中。这非常容易做到。</p>



<pre class="hljs">fig = px.line(talks, x=<span class="hljs-string">"published_year"</span>, y=<span class="hljs-string">"number_of_events"</span>)
fig.show()</pre>







<p id="separator-block_5fc6829cc1e9d" class="block-separator block-separator--5">Plotly 3D曲面</p>



<h2 id="h-plotly-annotations">现在让我们看看如何在Plotly中绘制3D曲面。类似于3D散点图，我们必须传递x、y和z参数。</h2>



<p>Plotly气泡图</p>



<pre class="hljs">fig = px.scatter(df,x=<span class="hljs-string">'comments'</span>,y=<span class="hljs-string">'views'</span>,color=<span class="hljs-string">'duration'</span>,text=<span class="hljs-string">"published_day"</span>)
fig.show()</pre>







<p id="separator-block_5fc6829fc1e9e" class="block-separator block-separator--5">绘制气泡图非常类似于散点图。事实上，它是根据散点图构建的。我们增加的唯一一项是气泡的大小。</p>



<h2 id="h-plotly-3d-scatter">绘图表</h2>



<p>Plotly还可用于将数据框可视化为表格。我们可以使用Plotly Graph Objects <code>Table</code>来实现这一点。我们将标题和单元格传递给表格。我们还可以指定如下所示的样式:</p>



<pre class="hljs">fig = px.scatter_3d(df,x=<span class="hljs-string">'comments'</span>,y=<span class="hljs-string">'views'</span>,z=<span class="hljs-string">'duration'</span>,color=<span class="hljs-string">'views'</span>)
fig.show()</pre>







<p id="separator-block_5fc682a4c1e9f" class="block-separator block-separator--5">打印热图</p>



<h2 id="h-plotly-write-to-html">我们可以用密度热图来形象化一个聚集函数的2D分布。聚合函数应用于z轴上的变量。该函数可以是总和、平均值甚至是计数。</h2>



<p>情节动画</p>



<pre class="hljs">fig.write_html(<span class="hljs-string">"3d.html"</span>)</pre>







<p id="separator-block_5fc682a8c1ea0" class="block-separator block-separator--5">Plotly动画可用于制作特定值随时间变化的动画。为了实现这一点，我们必须定义<code>animation_frame</code>。在这种情况下，是年份。</p>



<h2 id="h-plotly-3d-surface">箱形图</h2>



<p>箱线图显示了数据通过其四分位数的表示。落在第四个四分位数之外的值表示数据集中的异常值。</p>



<pre class="hljs">fig = go.Figure(data=[go.Surface(z=df[[<span class="hljs-string">'duration'</span>,<span class="hljs-string">'views'</span>,<span class="hljs-string">'comments'</span>]].values)])

fig.update_layout(title=<span class="hljs-string">'3D Surface'</span>, autosize=<span class="hljs-keyword">False</span>,
                  width=<span class="hljs-number">500</span>, height=<span class="hljs-number">500</span>,
                  margin=dict(l=<span class="hljs-number">65</span>, r=<span class="hljs-number">50</span>, b=<span class="hljs-number">65</span>, t=<span class="hljs-number">90</span>))

fig.show()</pre>







<p id="separator-block_5fc682bcc1ea1" class="block-separator block-separator--5">Plotly地图</p>



<h2 id="h-plotly-bubble-chart">为了在Plotly中使用地图，你需要前往<a href="https://web.archive.org/web/20221206044847/https://www.mapbox.com/" target="_blank" rel="noreferrer noopener nofollow">地图框</a>并获取你的地图框API密钥。有了手头的，您可以在地图上直观地显示您的数据。这是在传递纬度和经度时使用<code>scatter_mapbox</code>完成的。</h2>



<p>情节复杂的次要情节</p>



<pre class="hljs">fig = px.scatter(df,x=<span class="hljs-string">'comments'</span>,y=<span class="hljs-string">'views'</span>,size=<span class="hljs-string">'duration'</span>,color=<span class="hljs-string">'num_speaker'</span>, log_x=<span class="hljs-keyword">True</span>, size_max=<span class="hljs-number">60</span>)
fig.show()
</pre>







<p id="separator-block_5fc682c2c1ea2" class="block-separator block-separator--5">使用Plotly，我们还可以在同一个图形上可视化多个图。这是用情节主线完成的。通过定义一个<code>facet_col</code>来创建图形。图表将被分解成尽可能多的来自<code>facet_col</code>列的唯一值。</p>



<h2 id="h-plotly-table">Plotly误差线</h2>



<p>误差线用于显示可视化数据的可变性。一般来说，它们有助于显示估计误差或某一测量的精确度。误差线的长度揭示了不确定性的水平。误差线越长，表明数据点越分散，因此不确定性越大。它们可以应用于图表，如折线图、条形图和散点图。</p>



<pre class="hljs">fig = go.Figure(data=[go.Table(header=dict(values=views_top.columns,
                                           fill_color=<span class="hljs-string">'yellow'</span>,
),
                 cells=dict(values=[views_top[<span class="hljs-string">'event'</span>],views_top[<span class="hljs-string">'views'</span>]],
                            fill_color=<span class="hljs-string">'paleturquoise'</span>,
                           ))
                     ])
fig.show()</pre>







<p id="separator-block_5fc682c6c1ea3" class="block-separator block-separator--5">最后的想法</p>



<h2 id="h-plotly-heatmap">希望这篇文章向您展示了如何在下一个机器学习工作流程中使用Plotly。你甚至可以用它来可视化你的机器学习模型的性能指标。与其他工具不同，它的视觉效果既吸引眼球又具有互动性。</h2>



<p>交互性使您能够放大和缩小图表中的特定部分。这样，你可以看得更深一点，更详细地分析你的图表。具体来说，我们已经看到了如何在Plotly中使用流行的图表，如直方图、条形图和散点图。我们还看到，我们可以在同一个图形上构建多个图，并在地图上可视化数据。</p>



<pre class="hljs">fig = px.density_heatmap(df, x=<span class="hljs-string">"published_year"</span>, y=<span class="hljs-string">"views"</span>,z=<span class="hljs-string">"comments"</span>)
fig.show()
</pre>







<p id="separator-block_5fc682cac1ea4" class="block-separator block-separator--5">使用的笔记本可以在这里找到<a href="https://web.archive.org/web/20221206044847/https://nbviewer.jupyter.org/github/mwitiderrick/Neptune-Plotly/blob/1ac120b3c131c5bd371bfe2f9e1dfc39d5752a44/plotly.ipynb" target="_blank" rel="noreferrer noopener nofollow">。</a></p>



<h2 id="h-plotly-animations">快乐策划——没有双关语！</h2>



<p>Plotly Animations can be used to animate the changes in certain values over time. In order to achieve that, one has to define the <code>animation_frame</code>. In this case, it’s the year.</p>



<pre class="hljs">px.scatter(df, x=<span class="hljs-string">"duration"</span>, y=<span class="hljs-string">"comments"</span>,animation_frame=<span class="hljs-string">"published_year"</span>, size=<span class="hljs-string">"duration"</span>, color=<span class="hljs-string">"published_day"</span>)</pre>







<p id="separator-block_5fc682cec1ea5" class="block-separator block-separator--5">
</p>



<h2 id="h-plotly-box-plot">Plotly box plot</h2>



<p>A box plot shows the representation of data through their quartiles. Values falling outside the fourth quartile represent the outliers in your dataset.</p>



<pre class="hljs">fig = px.box(df, x=<span class="hljs-string">"published_day"</span>, y=<span class="hljs-string">"duration"</span>)
fig.show()
</pre>







<p id="separator-block_5fc682d6c1ea6" class="block-separator block-separator--5">
</p>



<h2 id="h-plotly-maps">Plotly maps</h2>



<p>In order to work with maps in Plotly, you will need to head over to <a href="https://web.archive.org/web/20221206044847/https://www.mapbox.com/" target="_blank" rel="noreferrer noopener nofollow">Mapbox</a> and grab your Mapbox API key. With the at hand, you can visualize your data on a map in Plotly. This is done using the <code>scatter_mapbox</code> while passing the latitude and the longitude. </p>



<pre class="hljs">px.set_mapbox_access_token(<span class="hljs-string">'YOURTOKEN'</span>)
fig = px.scatter_mapbox(df, lat=<span class="hljs-string">"lat"</span>, lon=<span class="hljs-string">"lon"</span>,
                        color=<span class="hljs-string">"region"</span>,
                        size=<span class="hljs-string">"views"</span>,
                  color_continuous_scale=
                        px.colors.cyclical.IceFire, size_max=<span class="hljs-number">15</span>)
fig.show()</pre>







<p id="separator-block_5fc682dfc1ea7" class="block-separator block-separator--5">
</p>



<h2 id="h-plotly-subplots">Plotly subplots</h2>



<p>With Plotly, we can also visualize multiple plots on the same graph. This is done using Plotly Subplots. The plots are created by defining a <code>facet_col</code>. The graphs will be broken into as many unique values as available from the <code>facet_col</code> column. </p>



<pre class="hljs">px.scatter(df, x=<span class="hljs-string">"duration"</span>, y=<span class="hljs-string">"comments"</span>,
           animation_frame=<span class="hljs-string">"published_month"</span>, animation_group=<span class="hljs-string">"event"</span>,
           facet_col=<span class="hljs-string">"published_day"</span>,width=<span class="hljs-number">1500</span>, height=<span class="hljs-number">500</span>,
           size=<span class="hljs-string">"views"</span>, color=<span class="hljs-string">"published_day"</span>,
          )</pre>







<p id="separator-block_5fc682e6c1ea8" class="block-separator block-separator--5">
</p>



<h2 id="h-plotly-error-bars">Plotly error bars</h2>



<p>Error bars are used to show the variability of data in a visualization. Generally, they help in showing the estimated error or the preciseness of a certain measure. The length of the error bar reveals the level of uncertainty. Longer error bars indicate that the data points are more spread out hence more uncertain. They can be applied to graphs such as line charts, bar graphs, and scatterplots.</p>



<pre class="hljs">fig =  go.Figure(
    data=[
        go.Bar(
    x=views_top[<span class="hljs-string">'event'</span>], y=views_top[<span class="hljs-string">'views'</span>],
    error_y=dict(type=<span class="hljs-string">'data'</span>, array=views_top[<span class="hljs-string">'error'</span>].values)
)
    ])
fig.show()</pre>







<p id="separator-block_5fc682ebc1ea9" class="block-separator block-separator--5">
</p>



<h2 id="h-final-thoughts">Final thoughts</h2>



<p>Hopefully, this piece has shown you how you can use Plotly in your next machine learning workflow. You can even use it to visualize the performance metrics of your machine learning models. Unlike other tools, its visuals are eye-catching as well as interactive. </p>



<p>The interactivity enables you to zoom in and out of specific parts in the graph. In this way, you can look a little deeper to analyze your graph in more detail. Specifically, we have seen how you can use popular graphs such as histograms, bar charts, and scatter plots in Plotly. We have also seen that we can build multiple plots on the same graph as well as visualize data on the map. </p>



<p>The Notebook used can be found <a href="https://web.archive.org/web/20221206044847/https://nbviewer.jupyter.org/github/mwitiderrick/Neptune-Plotly/blob/1ac120b3c131c5bd371bfe2f9e1dfc39d5752a44/plotly.ipynb" target="_blank" rel="noreferrer noopener nofollow">here</a>. </p>



<p>Happy plotting – no pun intended!</p>
        </div>
        
    </div>    
</body>
</html>