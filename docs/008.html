<html>
<head>
<title>Argo vs Airflow vs Prefect: How Are They Different </title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>阿尔戈vs气流vs完美:它们有什么不同</h1>
<blockquote>原文：<a href="https://web.archive.org/web/https://neptune.ai/blog/argo-vs-airflow-vs-prefect-differences#0001-01-01">https://web.archive.org/web/https://neptune.ai/blog/argo-vs-airflow-vs-prefect-differences#0001-01-01</a></blockquote><div><div class="l-content content-wrapper js-content">
            
<p>我们生活在一个ML和DL软件无处不在的阶段。新的创业公司和其他各种公司正在将人工智能系统适应和集成到他们新的和现有的工作流程中，以提高生产率和效率。这些系统减少了手动任务，提供了智能的解决方案。尽管他们对自己所做的事情相当精通，但所有的人工智能系统都有不同的模块，必须将这些模块组合在一起才能构建一个可操作的有效产品。</p>



<p>这些系统可以大致分为五个阶段，记住这些阶段包含各种附加的和重复的任务:</p>



<div id="case-study-numbered-list-block_8fb9f2e318eeb666ce5306ddd4305ddc" class="block-case-study-numbered-list ">

    
    <h2 id="h-"/>

    <ul class="c-list">
                    <li class="c-list__item"><span class="c-list__counter"> 1 </span>数据收集</li>
                    <li class="c-list__item"><span class="c-list__counter"> 2 </span>特色工程</li>
                    <li class="c-list__item">建模(包括训练、验证、测试和推理)</li>
                    <li class="c-list__item"><span class="c-list__counter"> 4 </span>部署</li>
                    <li class="c-list__item"><span class="c-list__counter"> 5 </span>监控</li>
            </ul>
</div>



<p>单独执行这些阶段会花费大量时间和持续的人力。这些阶段必须同步，并按顺序编排，以便充分利用它们。这可以通过<strong>任务编排工具</strong>来实现，这些工具使ML从业者能够毫不费力地将人工智能系统的不同阶段整合在一起并进行编排。</p>



<p id="separator-block_1a2475869ea1cf43bc2807deb583e3aa" class="block-separator block-separator--15"> </p>





<p id="separator-block_de1f5f20c22a4cc1abab8756d11e1439" class="block-separator block-separator--10"> </p>



<p>在本文中，我们将探索:</p>



<div id="case-study-numbered-list-block_91410d4b859b53150f683e123f1266c2" class="block-case-study-numbered-list ">

    
    <h2 id="h-"/>

    <ul class="c-list">
                    <li class="c-list__item"><span class="c-list__counter"> 1 </span>什么是任务编排工具？</li>
                    <li class="c-list__item">三种不同的工具可以帮助ML从业者协调他们的工作流程。</li>
                    <li class="c-list__item"><span class="c-list__counter"> 3 </span>三种工具的对比</li>
                    <li class="c-list__item"><span class="c-list__counter"> 4 </span>何时使用哪种工具？</li>
            </ul>
</div>







<p>编排工具使MLOps中的各种任务得以组织和顺序执行。这些工具能够在给定的时间内协调不同的任务。这些工具的关键属性之一是任务的分配。大多数工具利用了DAG或有向无环图，这在本文中会经常遇到。DAG是需要执行的任务的图形表示。</p>


<div class="wp-block-image">
<figure class="aligncenter size-large is-resized"><img decoding="async" loading="lazy" src="../Images/589715d97914b9518512b111648b9d93.png" alt="Explanation of DAG" class="wp-image-72253" data-recalc-dims="1" data-original-src="https://web.archive.org/web/20230106143932im_/https://i0.wp.com/neptune.ai/wp-content/uploads/argo-vs-airflow-vs-prefect-2-1024x928.png?resize=768%2C696&amp;ssl=1"/><figcaption class="wp-element-caption"><em>Graphic explanation of DAG | <a href="https://web.archive.org/web/20230106143932/https://www.datarevenue.com/en-blog/airflow-vs-luigi-vs-argo-vs-mlflow-vs-kubeflow" target="_blank" rel="noreferrer noopener nofollow">Source</a> </em></figcaption></figure></div>


<p id="separator-block_de1f5f20c22a4cc1abab8756d11e1439" class="block-separator block-separator--10"> </p>



<p>DAG使管道中的任务能够并行分配给各种其他模块进行处理，这提供了效率。见上图。DAG还使任务能够按顺序合理地执行或安排，以获得正确的执行和及时的结果。</p>



<p>这些工具的另一个重要特性是对敏捷环境的适应性。这使得ML从业者可以整合各种其他工具，用于监控、部署、分析和预处理、测试、推断等。如果一个编排工具可以从不同的工具中编排不同的任务，那么它可以被认为是一个好工具。但并非每次都是如此，一些工具被严格地包含在它们的派生环境中，这对于试图集成任何第三方应用程序的用户来说不是一个好兆头。</p>



<p>在本文中，我们将探索三个工具——<a href="https://web.archive.org/web/20230106143932/https://argoproj.github.io/" target="_blank" rel="noreferrer noopener nofollow">Argo</a>、<a href="https://web.archive.org/web/20230106143932/https://airflow.apache.org/" target="_blank" rel="noreferrer noopener nofollow">气流</a>和<a href="https://web.archive.org/web/20230106143932/https://www.prefect.io/" target="_blank" rel="noreferrer noopener nofollow">提督</a>，它们结合了这两个属性以及其他各种属性。</p>



<h2 id="h-tldr-comparison-table">TL；灾难恢复对照表</h2>



<p>这里有一个受Ian McGraw文章启发的表格，它概述了这些工具为编排提供了什么，以及它们在这些方面有何不同。</p>



<div id="medium-table-block_6078cc380974d9f852ba71cbfa0ac177" class="block-medium-table c-table__outer-wrapper ">

    <table class="c-table">
                    <thead class="c-table__head">
            <tr>
                                    <td class="c-item">
                        <p class="c-item__inner">                                                      </p>
                    </td>
                                    <td class="c-item">
                        <p class="c-item__inner">特征</p>
                    </td>
                                    <td class="c-item">
                        <p class="c-item__inner">南船星座</p>
                    </td>
                                    <td class="c-item">
                        <p class="c-item__inner">气流</p>
                    </td>
                                    <td class="c-item">
                        <p class="c-item__inner">长官</p>
                    </td>
                            </tr>
            </thead>
        
        <tbody class="c-table__body">

                    
                <tr class="c-row">

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil"><div class="c-ceil__inner"><p/></div>容错调度</td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                </tr>

            
                <tr class="c-row">

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                </tr>

            
                <tr class="c-row">

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil"><div class="c-ceil__inner"> <p>工作流定义语言</p> </div></td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                </tr>

            
                <tr class="c-row">

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil">由于Argo是基于容器的，它没有预装第三方系统。T3】</td>

                    
                        <td class="c-ceil"><div class="c-ceil__inner"> <p>支持各种第三方集成</p> </div></td>

                    
                        <td class="c-ceil"><div class="c-ceil__inner"> <p>支持各种第三方集成</p> </div></td>

                    
                </tr>

            
                <tr class="c-row">

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                </tr>

            
                <tr class="c-row">

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil"><div class="c-ceil__inner"> <p>【混合(开源和基于订阅)</p> </div></td>

                    
                </tr>

            
                <tr class="c-row">

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil"><div class="c-ceil__inner"> <p>有广泛的参数传递语法。</p>T3】</div></td>

                    
                        <td class="c-ceil"><div class="c-ceil__inner"> <p>没有传递参数的机制。</p>T3】</div></td>

                    
                        <td class="c-ceil"><div class="c-ceil__inner"> <p>支持参数作为一级对象</p> </div></td>

                    
                </tr>

            
                <tr class="c-row">

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                </tr>

            
                <tr class="c-row">

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil"><div class="c-ceil__inner"> <p>并联时使用Kubernetes </p> </div></td>

                    
                </tr>

            
                <tr class="c-row">

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                </tr>

            
                <tr class="c-row">

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil"><div class="c-ceil__inner"> <p>所有状态都存储在Kubernetes工作流内</p> </div></td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                </tr>

            
                <tr class="c-row">

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                </tr>

            
                <tr class="c-row">

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                </tr>

            
                <tr class="c-row">

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil"><div class="c-ceil__inner"> <p>脚本中的DAG定义</p> </div></td>

                    
                        <td class="c-ceil"><div class="c-ceil__inner"> <p> Argo使用文本脚本传入容器。</p>T3】</div></td>

                    
                        <td class="c-ceil"><div class="c-ceil__inner"> <p> Airflow使用基于Python的DAG定义语言。</p>T3】</div></td>

                    
                        <td class="c-ceil"><div class="c-ceil__inner"> <p> Perfect使用基于Python的API函数流。</p>T3】</div></td>

                    
                </tr>

            
                <tr class="c-row">

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil"><div class="c-ceil__inner"><p>–CI/CD-数据处理-基础设施自动化-机器学习-流处理</p> </div></td>

                    
                        <td class="c-ceil"><div class="c-ceil__inner"><p>–ELT–ML工作流- ML自动化</p> </div></td>

                    
                        <td class="c-ceil"><div class="c-ceil__inner"><p>–自动化数据工作流(ELT)–ML工作流和流程编排——CI/CD</p></div></td>

                    
                </tr>

                    
        </tbody>
    </table>

</div>



<p>现在，让我们在三个主要类别下更详细地探讨这些工具:</p>



<div id="case-study-numbered-list-block_dddd3f0beb5ac03bbd1aab5378b1fee1" class="block-case-study-numbered-list ">

    
    <h2 id="h-"/>

    <ul class="c-list">
                    <li class="c-list__item"><span class="c-list__counter"> 1 </span>核心概念</li>
                    <li class="c-list__item">他们提供的功能</li>
                    <li class="c-list__item"><span class="c-list__counter"> 3 </span>为什么要用？</li>
            </ul>
</div>



<h2 id="h-core-concepts">核心概念</h2>



<p>所有这三种工具都是建立在一套概念或原则之上的，它们都是围绕着这些概念或原则运行的。例如，Argo是围绕两个概念构建的:<strong>工作流</strong>和<strong>模板</strong>。这两者构成了其系统的主干。同样，Airflow是围绕<strong>web服务器、【调度器】、执行器、</strong>和<strong>数据库、</strong>构建的，而Prefect是围绕<strong>流</strong>和<strong>任务</strong>构建的。现在重要的是我们要知道这些概念意味着什么，它们提供了什么，以及它如何对我们有益。</p>



<p>在进入细节之前，这里有一个概念的简要概述。</p>



<div id="medium-table-block_1bef54a85a304ee96f66127d4d1b3d93" class="block-medium-table c-table__outer-wrapper ">

    <table class="c-table">
                    <thead class="c-table__head">
            <tr>
                                    <td class="c-item">
                        <p class="c-item__inner">                                                      </p>
                    </td>
                                    <td class="c-item">
                        <p class="c-item__inner">概念的属性</p>
                    </td>
                            </tr>
            </thead>
        
        <tbody class="c-table__body">

                    
                <tr class="c-row">

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil"><div class="c-ceil__inner"> <p>它有两个概念<strong>工作流</strong>，和<strong>模板</strong>。本质上，工作流是配置YAML文件。它为工作流提供了结构和健壮性，因为它们使用Dag来管理工作流。另一方面，模板是需要执行的功能。<br data-rich-text-line-break="true"/>它们既是静态的也是动态的，这意味着您可以随时修改步骤。</p> </div></td>

                    
                </tr>

            
                <tr class="c-row">

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil"><div class="c-ceil__inner"> <p>它有四个概念Webserver、Scheduler、Executor、Database。他们基本上把整个过程分成不同的部分，这些概念作为主要的组成部分使整个过程自动化。这使得工作流变得高效，因为每个组件都依赖于另一个组件，这样就很容易找到并报告错误和错误。此外，监控相当容易。<br/>虽然气流使用DAGs，但它不是动态的，而只是静态的。</p> </div></td>

                    
                </tr>

            
                <tr class="c-row">

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil"><div class="c-ceil__inner"> <p>它利用了两个概念流和任务。提督使用定义为使用Python的流对象的Dag。在Prefect中，可以使用Python创建流对象，这提供了定义复杂管道的灵活性和健壮性。<br/>任务就像Argo中的模板，用于定义需要执行的特定功能。同样，它使用Python来实现这一点。<br/>因为Prefect使用Python作为它的主要编程语言，所以很容易使用。</p> </div></td>

                    
                </tr>

                    
        </tbody>
    </table>

</div>



<p class="has-text-align-center has-small-font-size"><em>概念概述</em></p>



<p>现在，我们来详细了解一下这些概念。</p>



<h3>南船星座</h3>



<p>Argo使用两个核心概念:</p>



<ol>
<li>工作流程</li>



<li>模板</li>
</ol>



<h4>工作流程</h4>



<p>在Argo中，工作流恰好是整个系统最完整的组成部分。它有两个重要的功能:</p>



<ol>
<li>它定义了需要执行的任务。</li>



<li>它存储任务的状态，这意味着它既是静态对象又是动态对象。</li>
</ol>



<p>工作流是在workflow.spec配置文件中定义的。这是一个YAML文件，由一列<strong>模板</strong>和<strong>入口点</strong>组成。工作流可以被视为一个托管不同模板的文件。这些模板定义了需要执行的功能。</p>



<p>如前所述，Argo利用<strong> Kubernetes </strong>引擎进行工作流同步，配置文件使用与Kubernetes相同的语法。工作流YAML文件包含以下字典或对象:</p>



<ol>
<li>apiVersion:这是定义文档或API名称的地方。</li>



<li>kind:它定义了需要创建的Kubernetes对象的类型。例如，如果你想部署一个应用程序，你可以使用<strong> Deployment </strong>作为其中之一，其他时候你可以使用service。但是在这种情况下，我们将使用<strong>工作流</strong>。</li>



<li>元数据:它使我们能够为该对象定义唯一的属性，可以是名称、UUID等等。</li>



<li>规范:它使我们能够定义关于工作流的规范。这些规范将是入口点和模板。</li>



<li>模板:这是我们可以定义任务的地方。该模板可以包含docker图像和各种其他脚本。</li>
</ol>



<h4>模板</h4>



<p>在Argo中，有两种类型的模板，它们又被细分为6种类型。两种主要类型是<strong>定义</strong>和<strong>调用方。</strong></p>



<h5>定义</h5>



<p>顾名思义，这个模板定义了Docker容器中的任务类型。定义本身分为四类:</p>



<ol>
<li><strong>容器</strong>:用户可以在容器中安排工作流。由于应用程序在Kubernetes中是容器化的，所以YAML文件中定义的步骤是相同的。它也是最常用的模板之一。</li>
</ol>



<pre class="hljs">
- name: whalesay
    container:
      image: docker/whalesay
      command: [cowsay]
      args: [<span class="hljs-string">"hello world"</span>]</pre>



<ol start="2">
<li><strong>脚本</strong>:如果你想要一个容器包装器，那么脚本模板是完美的。脚本模板在结构上类似于容器模板，但添加了一个源字段。该字段允许您就地定义脚本。您可以根据自己的需求定义任何变量或命令。一旦定义，脚本将被保存到一个文件中，它将作为一个Argo变量为您执行。</li>
</ol>



<pre class="hljs">
 - name: gen-random-int
    script:
      image: python:alpine3<span class="hljs-number">.6</span>
      command: [python]
      source: <span class="hljs-keyword">import</span> random

        	i = random.randint(<span class="hljs-number">1</span>, <span class="hljs-number">100</span>)
        	  	print(i)
</pre>



<ol start="3">
<li><strong>资源</strong>:可以直接在K8集群上进行获取、创建、应用、删除等操作。</li>
</ol>



<pre class="hljs">
- name: k8s-owner-reference
    resource:
      action: create
      manifest: |
        apiVersion: v1
        kind: ConfigMap
        metadata:
          generateName: owned-eg-
        data:
          some: value</pre>



<ol start="4">
<li><strong>暂停</strong>:基本上是给工作流引入一个时间维度。它可以在定义的持续时间内暂停工作流的执行，或者手动恢复工作流。</li>
</ol>



<pre class="hljs">
 - name: delay
    suspend:
      duration: <span class="hljs-string">"20s"</span></pre>



<h5>创新者</h5>



<p>一旦定义了模板，它们就可以被调用，或者被称为调用程序的其他模板按需调用。这些调用程序更多的是控制器模板，可以控制已定义模板的执行。</p>



<p>有两种类型的发票模板:</p>



<ol>
<li><strong>步骤:</strong>基本上可以让你分步骤定义任务。所有YAML文件都启用了“步骤”模板。</li>



<li>有向无环图(Directed acyclic graph):Argo使其用户能够管理其工作流程中具有多种依赖关系的步骤。这允许在各自的容器中并行执行不同的工作流。使用有向非循环图或DAG来管理这些类型的工作流。例如，如果您正在处理用于医疗目的的图像分割和生成，那么您可以创建一个管道:<ul>
<li>处理图像。</li>



<li>将图像(或数据集)分发到相应的DL模型，用于图像分割和生成管道。</li>



<li>持续预测分割掩模，并在适当检查后用新图像更新数据集存储。</li>
</ul>
</li>
</ol>



<h3>气流</h3>





<p>阿帕奇气流由四个主要部分组成:</p>



<ol>
<li>网络服务器</li>



<li>调度程序</li>



<li>执行者</li>



<li>数据库ˌ资料库</li>
</ol>


<div class="wp-block-image">
<figure class="aligncenter size-full is-resized"><img decoding="async" loading="lazy" src="../Images/75a2f294370bf533c998f5c58115c2e0.png" alt="Main components of Apache Airflow" class="wp-image-72255" data-recalc-dims="1" data-original-src="https://web.archive.org/web/20230106143932im_/https://i0.wp.com/neptune.ai/wp-content/uploads/argo-vs-airflow-vs-prefect-4.png?resize=744%2C484&amp;ssl=1"/><figcaption class="wp-element-caption"><em> Four main components of Apache Airflow | <a href="https://web.archive.org/web/20230106143932/https://airflow.apache.org/docs/apache-airflow/stable/concepts/overview.html" target="_blank" rel="noreferrer noopener nofollow">Source</a></em></figcaption></figure></div>


<h4>网络服务器</h4>



<p>它为用户提供了检查、触发和调试所有Dag和任务的UI。它实际上是气流的入口。web服务器利用Python-Flask来管理用户发出的所有请求。它还呈现数据库中的状态元数据，并将其显示给UI。</p>



<h4>调度程序</h4>



<p>它监控和管理所有任务和Dag。它通过查询数据库来检查任务的状态，以决定需要执行的任务的顺序。调度器的目标是解决依赖关系，一旦依赖关系得到处理，就将任务实例提交给执行器。</p>



<h4>执行者</h4>



<p>它运行准备运行的任务实例。它执行调度程序调度的所有任务。遗嘱执行人有四种类型:</p>



<ol>
<li>顺序执行者</li>



<li>本地执行者</li>



<li>芹菜执行者</li>



<li>Kubernetes Executor</li>
</ol>



<h4>元数据数据库</h4>



<p>它存储任务和Dag的状态，调度程序可以使用这些状态来正确调度任务实例。值得注意的是，Airflow使用SQLAlchemy和对象关系映射(ORM)来存储信息。</p>



<h3>长官</h3>



<p>提督使用两个核心概念:</p>



<ol>
<li>流</li>



<li>任务</li>
</ol>



<h4>流</h4>



<p>在Prefect中，流是可以交互的Python对象。这里DAG被定义为流对象。见下图。</p>



<p id="separator-block_1a2475869ea1cf43bc2807deb583e3aa" class="block-separator block-separator--15"> </p>


<div class="wp-block-image">
<figure class="aligncenter size-large"><img decoding="async" src="../Images/a7e300b5a98018dc2b35c4b32a21edab.png" alt="DAG defined as flow objects " class="wp-image-72256" data-recalc-dims="1" data-original-src="https://web.archive.org/web/20230106143932im_/https://i0.wp.com/neptune.ai/wp-content/uploads/argo-vs-airflow-vs-prefect-5-1024x172.png?resize=1024%2C172&amp;ssl=1"/><figcaption class="wp-element-caption"><em> DAG defined as flow objects | <a href="https://web.archive.org/web/20230106143932/https://spell.ml/blog/orchestrating-spell-model-pipelines-using-prefect-YU3rsBEAACEAmRxp" target="_blank" rel="noreferrer noopener nofollow">Source</a></em></figcaption></figure></div>


<p id="separator-block_1a31e0f7eaf92c77e2ac2ec4e92ac849" class="block-separator block-separator--5"> </p>



<p>对于任何给定的函数，Flow可以被导入并用作装饰器@flow。流采用现有的函数，并将其转换为完美的流函数，具有以下优点:</p>



<ul>
<li>该功能可以被监控和管理，因为它现在被报告给API。</li>



<li>可以在UI中跟踪和显示功能的活动。</li>



<li>可以验证函数的输入。</li>



<li>诸如重试、分布式执行等各种工作流特征可以被添加到该功能中。<em> </em></li>



<li>可以强制超时，以防止无意中长时间运行的工作流</li>
</ul>



<p>下面是一个代码块，描述了一个流对象的实现。</p>



<pre class="hljs">
<span class="hljs-keyword">from</span> prefect <span class="hljs-keyword">import</span> flow

<span class="hljs-meta">@flow(name="GitHub Stars")</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">github_stars</span><span class="hljs-params">(repos: List[str])</span>:</span>
    <span class="hljs-keyword">for</span> repo <span class="hljs-keyword">in</span> repos:
        get_stars(repo)
</pre>



<p>在上面的代码中，函数被转换成一个流，命名为“GitHub Stars”。这个功能现在在完美的编排法则的约束之内。</p>



<p>现在必须注意，所有工作流都必须在流函数中定义。同样，所有任务都必须在流(函数)中调用。请记住，当一个流被执行时，它被称为<em>流运行</em>。</p>



<h5>任务</h5>



<p>任务可以定义为需要执行的特定工作，例如，两个数的相加。换句话说，任务接受输入，执行操作并产生输出。像flow一样，任务可以被导入，并可以作为一个函数的装饰器@task使用。一旦用于某个功能，它本质上将该功能包装在完美的工作流中，并且具有与流程相似的优点。例如，它可以自动记录关于任务运行的信息，比如运行时间、标签和最终状态。</p>



<p>下面的代码演示了如何定义任务:</p>



<pre class="hljs">

<span class="hljs-meta">@task(retries=3)</span>
<span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_stars</span><span class="hljs-params">(repo: str)</span>:</span>
    url = f<span class="hljs-string">"https://api.github.com/repos/{repo}"</span>
    count = httpx.get(url).json()[<span class="hljs-string">"stargazers_count"</span>]
    print(f<span class="hljs-string">"{repo} has {count} stars!"</span>)


github_stars([<span class="hljs-string">"PrefectHQ/Prefect"</span>])</pre>



<p>总而言之，流程寻找任何在其主体中定义的任务，一旦找到，它就以相同的顺序创建一个计算图。然后，每当一个任务实例的输出被另一个任务实例用来产生输出时，它就在任务之间创建依赖关系。</p>



<h2 id="h-features">特征</h2>



<p>这三者都提供了或多或少相同的功能，但有些功能比其他功能更好，这也归结于用户的适应性。就像上一节一样，我们先来总结一下这些特性。</p>



<div id="medium-table-block_93f662c2568885d9ff64a5e751dabbfd" class="block-medium-table c-table__outer-wrapper ">

    <table class="c-table">
                    <thead class="c-table__head">
            <tr>
                                    <td class="c-item">
                        <p class="c-item__inner">                                                      </p>
                    </td>
                                    <td class="c-item">
                        <p class="c-item__inner">南船星座</p>
                    </td>
                                    <td class="c-item">
                        <p class="c-item__inner">气流</p>
                    </td>
                                    <td class="c-item">
                        <p class="c-item__inner">长官</p>
                    </td>
                            </tr>
            </thead>
        
        <tbody class="c-table__body">

                    
                <tr class="c-row">

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil"><div class="c-ceil__inner"> <p>它拥有完整的工作流视图。您可以直接从UI定义工作流。</p>T3】</div></td>

                    
                        <td class="c-ceil">工作流维护得非常好，因为它提供了许多不同的视图。T3】</td>

                    
                        <td class="c-ceil"><div class="c-ceil__inner"> <p>提督类似于气流。</p>T3】</div></td>

                    
                </tr>

            
                <tr class="c-row">

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil"><div class="c-ceil__inner"> <p>仅支持Kubernetes支持的环境，如AWS和其他S3兼容的服务。</p>T3】</div></td>

                    
                        <td class="c-ceil"><div class="c-ceil__inner"> <p>支持Kubernetes支持的环境以及其他第三方环境。</p>T3】</div></td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                </tr>

            
                <tr class="c-row">

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                </tr>

            
                <tr class="c-row">

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil"><div class="c-ceil__inner"><p/></div></td>

                    
                </tr>

            
                <tr class="c-row">

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil">                                                      </td>

                    
                </tr>

                    
        </tbody>
    </table>

</div>



<p class="has-text-align-center has-small-font-size"><em>特征比较</em></p>



<p>让我们从探索用户界面开始这一部分。</p>



<h3>用户界面</h3>



<h4>南船星座</h4>



<p>为了便于使用，Argo Workflow提供了一个基于web的用户界面来定义工作流和模板。用户界面支持多种用途，例如:</p>



<ul>
<li>人工制品可视化</li>



<li>使用生成的图表来比较机器学习管道</li>



<li>可视化结果</li>



<li>排除故障</li>



<li>它还可以用于定义工作流</li>
</ul>



<p id="separator-block_063e430cfbfadabbcde40db0b5e58df5" class="block-separator block-separator--10">气流</p>





<h4>Airflow UI提供了一个简洁高效的设计，使用户能够与Airflow服务器进行交互，允许他们<strong>监控</strong>和<strong>对整个管道进行故障排除</strong>。它还允许编辑数据库中任务的状态，并操纵Dag和任务的行为。</h4>



<p>Airflow UI还为其用户提供了各种视图，包括:</p>





<p>DAGs视图</p>



<ul>
<li>数据集视图</li>



<li>网格视图</li>



<li>图表视图</li>



<li>日历视图</li>



<li>可变视图</li>



<li>甘特图视图</li>



<li>任务持续时间</li>



<li>Code View</li>



<li>Prefect</li>
</ul>



<h4>Prefect like Airflow提供了所有任务的概述，这有助于您可视化所有工作流、任务和Dag。它提供了两种访问用户界面的方法:</h4>



<p><strong>完美云</strong>:它托管在云上，使您能够配置您的个人帐户和工作区。</p>



<ol>
<li><strong>提督猎户座UI </strong>:本地托管，也是开源的。您不能像使用Prefect cloud那样配置它。</li>



<li>perfect ui的一些附加功能:</li>
</ol>





<p>显示运行摘要</p>



<ul>
<li>显示已部署的流详细信息</li>



<li>预定流量</li>



<li>延迟和失败运行的警告通知</li>



<li>任务和工作流的详细信息</li>



<li>任务相关性可视化和雷达流程</li>



<li>日志详细信息</li>



<li>部署风格</li>
</ul>



<h3>南船星座</h3>



<h4>它是一个本地Kubernetes工作流引擎，这意味着:</h4>



<p>It is a native Kubernetes workflow engine which means it:</p>



<div id="case-study-numbered-list-block_9534e29fd26811ea12e384e75357482d" class="block-case-study-numbered-list ">

    
    <h2 id="h-"><span class="c-list__counter"> 1 </span>在容器上运行。</h2>

    <ul class="c-list">
                    <li class="c-list__item">2 在Kubernetes支持的吊舱上运行。</li>
                    <li class="c-list__item"><span class="c-list__counter"> 3 </span>易于部署和扩展。</li>
                    <li class="c-list__item">缺点是:</li>
            </ul>
</div>



<p>实现是困难的，因为它使用配置语言(YAML)。</p>



<ul>
<li>气流</li>
</ul>



<h4><span class="c-list__counter"> 1 </span>支持Kubernetes以及其他第三方集成。</h4>



<div id="case-study-numbered-list-block_8a83e1308936ba2cfba7d5ae62381a9a" class="block-case-study-numbered-list ">

    
    <h2 id="h-">它也可以在容器上运行。</h2>

    <ul class="c-list">
                    <li class="c-list__item"><span class="c-list__counter"> 3 </span>实现起来很容易。</li>
                    <li class="c-list__item">气流的缺点是:</li>
                    <li class="c-list__item">它不是并行可伸缩的。</li>
            </ul>
</div>



<p>部署需要额外的努力，这取决于您选择的云设施。</p>



<ul>
<li>长官</li>



<li>最后，提督是阿尔戈和气流的结合体:</li>
</ul>



<h4>Prefect</h4>



<p>它可以在容器和Kubernetes豆荚上运行。</p>



<div id="case-study-numbered-list-block_6058393be57ffaaa79c8ca34cd0ca4d3" class="block-case-study-numbered-list ">

    
    <h2 id="h-"><span class="c-list__counter"> 2 </span>它是高度并行和高效的。</h2>

    <ul class="c-list">
                    <li class="c-list__item">支持容错调度。</li>
                    <li class="c-list__item"><span class="c-list__counter"> 4 </span>易于部署。</li>
                    <li class="c-list__item">它还支持第三方集成。</li>
                    <li class="c-list__item">说到坏处:</li>
                    <li class="c-list__item">它不支持Kubernetes的开源部署。</li>
            </ul>
</div>



<p>部署困难。</p>



<ul>
<li>可量测性</li>



<li>当谈到可伸缩性时，Argo和Prefect是高度并行的，这使它们高效且特别完美，因为它可以利用不同的第三方集成支持，使其成为三者中最好的。</li>
</ul>



<h3>另一方面，气流是水平可扩展的，即活动工作者的数量等于最大任务并行度。</h3>



<p>易接近</p>



<p>这三个都是开源的，但是Prefect还附带了一个基于订阅的服务。</p>



<h3>灵活性</h3>



<p>与Prefect相比，Argo和Airflow并不灵活，因为前者是Kubernetes-native，它被限制在该环境中，使其变得僵化，而后者很复杂，因为它需要定义良好和结构化的模板，使其本身不太适合敏捷环境。</p>



<h3>另一方面，Prefect使您能够用原生Python创建动态数据流，这不需要您使用DAG。所有Python函数都可以转换成完美的流程和任务。这确保了灵活性。</h3>



<p>到目前为止，我已经比较了这些工具拥有的基本概念和特性。现在让我给出为什么你可以在你的项目中使用这些工具的理由。</p>



<p>南船星座</p>







<p>以下是您应该使用Argo的一些原因:</p>



<h3>Argo</h3>



<p>Kubernetes本地工作流工具使您能够在它自己的Kubernetes pod中运行每个步骤。</p>



<div id="case-study-numbered-list-block_7c3a28031a82c6fbbaadc383748b3c55" class="block-case-study-numbered-list ">

    
    <h2 id="h-"><span class="c-list__counter"> 2 </span>易于扩展，因为它可以并行执行。</h2>

    <ul class="c-list">
                    <li class="c-list__item">工作流模板提供了可重用性。</li>
                    <li class="c-list__item">类似地，工件集成也是可重用的。</li>
                    <li class="c-list__item">对于工作流的每次运行，DAG都是动态的。</li>
                    <li class="c-list__item"><span class="c-list__counter"> 6 </span>低延迟调度器。</li>
                    <li class="c-list__item">事件驱动的工作流。</li>
                    <li class="c-list__item">气流</li>
                    <li class="c-list__item">您使用气流的原因:</li>
            </ul>
</div>



<h3>Airflow</h3>



<p>它使用户能够连接各种技术。</p>



<div id="case-study-numbered-list-block_c0af8bcfe38bccc2ebd32c9ec2c4588a" class="block-case-study-numbered-list ">

    
    <h2 id="h-">它提供了丰富的调度和易于定义的管道。</h2>

    <ul class="c-list">
                    <li class="c-list__item"><span class="c-list__counter">3</span>python集成是使用气流的另一个原因。</li>
                    <li class="c-list__item">您可以根据自己的需求创建定制组件。</li>
                    <li class="c-list__item"><span class="c-list__counter"> 5 </span>存储工作流程时，允许回滚到先前版本。</li>
                    <li class="c-list__item"><span class="c-list__counter"> 6 </span>有一个定义良好的UI。</li>
                    <li class="c-list__item">多个用户可以为一个给定的项目编写一个工作流，即它是可共享的。</li>
                    <li class="c-list__item">长官</li>
                    <li class="c-list__item">Prefect是MLops精心设计的编排工具之一。它是Python原生的，需要你在工程方面下功夫。Prefect的一个亮点是数据处理和管道。它可以用于获取数据、应用必要的转换，以及监控和编排必要的任务。</li>
            </ul>
</div>



<h3>当涉及到与机器学习相关的任务时，它可以用于自动化整个数据流。</h3>



<p>使用提督的其他一些原因是:</p>



<p>When it comes to tasks related to machine learning, it can be used to automate the entire data flow. </p>



<p><span class="c-list__counter"> 1 </span>提供卓越的安全性，因为它可以保护您的数据和代码的隐私。</p>



<div id="case-study-numbered-list-block_b16c6afb0237d5b45cd20291ed74f74b" class="block-case-study-numbered-list ">

    
    <h2 id="h-"><span class="c-list__counter"> 2 </span>增强的用户界面和通知功能，可直接发送到您的电子邮件或Slack。</h2>

    <ul class="c-list">
                    <li class="c-list__item"><span class="c-list__counter"> 3 </span>可搭配Kubernetes和Docker使用。</li>
                    <li class="c-list__item"><span class="c-list__counter"> 4 </span>任务的高效并行处理。</li>
                    <li class="c-list__item"><span class="c-list__counter"> 5 </span>动态工作流。</li>
                    <li class="c-list__item"><span class="c-list__counter"> 6 </span>允许许多第三方集成。</li>
                    <li class="c-list__item"><span class="c-list__counter"> 7 </span> Prefect使用GraphQL API，使其能够按需触发工作流。</li>
                    <li class="c-list__item">如何决定？</li>
                    <li class="c-list__item">为您的项目选择合适的工具取决于您想要的和您已经拥有的。但是我肯定可以提出一些标准来帮助您决定哪种工具适合您。您可以使用–</li>
            </ul>
</div>



<h2 id="h-how-to-decide">南船星座</h2>



<p>如果你想建立一个基于Kubernetes的工作流。</p>



<h3>如果您想将工作流定义为Dag。</h3>



<ul>
<li>如果数据集很大，并且模型训练需要高度并行和分布式的训练。</li>



<li>如果你的任务很复杂。</li>



<li>如果你精通YAML档案。即使你不是，学习YAML也不难。</li>



<li>如果你想使用像GCD或AWS这样的云平台，这是Kubernetes启用的。</li>



<li>气流</li>



<li>如果您想整合许多其他第三方技术，如Jenkins、Airbyte、Amazon、Cassandra、Docker等。检查受支持的第三方扩展列表。</li>
</ul>



<h3>如果你想用Python来定义工作流。</h3>



<ul>
<li>如果您想将工作流定义为Dag。</li>



<li>如果你的工作流程是静态的。</li>



<li>如果你想要一个成熟的工具，因为气流是相当古老的。</li>



<li>如果您想按计划运行任务。</li>



<li>长官</li>



<li>如果您想整合许多其他第三方技术。</li>
</ul>



<h3>如果你想用Python来定义工作流。</h3>



<ul>
<li>如果你的工作流程是动态的。</li>



<li>如果您想按计划运行任务。</li>



<li>如果你想要轻松现代的东西。</li>



<li>我在Reddit 上发现了一个关于使用气流和提督的帖子。也许这可以为您提供一些关于使用哪种工具的附加信息。</li>



<li>“Airflow的优势在于它是一个成熟且受欢迎的项目。这意味着找到一个随机写博客回答你的问题的人要容易得多。另一个好处是，雇佣有气流经验的人比雇佣有完美经验的人要容易得多。缺点是，Airflow的时代正在显现，因为它并不是真正为现代数据环境中存在的那种动态工作流而设计的。如果你的公司要在<em>计算或复杂性方面突破极限，我强烈建议你考虑一下Prefect。</em>此外，除非你通过天文学家网站，否则如果你找不到关于气流的问题的答案，你必须通过他们相当不活跃的聊天。</li>
</ul>



<p>Prefect的优点是，它对你在做什么和它需要做什么的假设更加现代。它有一个扩展的API，允许你以编程的方式控制执行或者与调度程序交互，我相信Airflow只是最近才在他们的2.0版本中实现了测试版。在此之前，建议不要在生产环境中使用API，这通常会导致黑客式的解决方法。此外，通过确定在运行时执行的DAG，然后将计算/优化交给其他系统(即Dask)来实际执行任务，Prefect允许更动态的执行模型及其一些概念。我相信这是一个更聪明的方法，因为我已经看到工作流这些年来变得越来越动态。</p>



<p>如果我的公司既没有Airflow也没有Prefect，我会选择Prefect。我相信它允许更好的代码模块化(然后可以更积极/彻底地测试)，我已经认为这对于数据驱动的公司来说是值得的，这些公司依靠精心策划的数据来做出自动化的产品决策。你可以用气流实现类似的东西，但是你真的需要用你自己的方式来实现这样的事情，而在Prefect中，它是自然产生的。"</p>



<p>这里有一个有用的图表，展示了基于GitHub stars的不同编排工具的流行程度。</p>



<p>结论</p>



<p>在本文中，我们讨论并比较了三种流行的任务编排工具，即Argo、Airflow和Prefect。我的主要目的是在三个重要因素的基础上帮助您理解这些工具，即核心概念、提供的功能以及您为什么应该使用它们。本文还对这三种工具提供的一些重要特性进行了比较，这可以帮助您决定为您的项目选择最合适的工具。</p>



<p id="separator-block_f23d2ea42f6f7e22f50891a473a7769e" class="block-separator block-separator--15">我希望这篇文章内容丰富，能让您更好地理解这些工具。</p>


<div class="wp-block-image">
<figure class="aligncenter size-large"><img decoding="async" src="../Images/c02780808d0c1b93bb0827fe0b464871.png" alt="Chart illustrating the popularity of different orchestration tools" class="wp-image-72260" data-recalc-dims="1" data-original-src="https://web.archive.org/web/20230106143932im_/https://i0.wp.com/neptune.ai/wp-content/uploads/argo-vs-airflow-vs-prefect-9-1024x717.png?resize=1024%2C717&amp;ssl=1"/><figcaption class="wp-element-caption"><em>The popularity of different orchestration tools based on GitHub stars | <a href="https://web.archive.org/web/20230106143932/https://www.datarevenue.com/en-blog/airflow-vs-luigi-vs-argo-vs-mlflow-vs-kubeflow" target="_blank" rel="noreferrer noopener nofollow">Source</a></em></figcaption></figure></div>


<h2 id="h-conclusion">谢谢！！！</h2>



<p>参考</p>



<p><a href="https://web.archive.org/web/20230106143932/https://github.com/argoproj/argo-workflows" target="_blank" rel="noreferrer noopener nofollow">https://github.com/argoproj/argo-workflows</a></p>



<p><a href="https://web.archive.org/web/20230106143932/https://argoproj.github.io/" target="_blank" rel="noreferrer noopener nofollow">https://argoproj.github.io/</a></p>



<h3><a href="https://web.archive.org/web/20230106143932/https://codefresh.io/learn/argo-workflows/" target="_blank" rel="noreferrer noopener nofollow">https://codefresh.io/learn/argo-workflows/</a></h3>



<ol>
<li><a href="https://web.archive.org/web/20230106143932/https://hazelcast.com/glossary/directed-acyclic-graph/" target="_blank" rel="noreferrer noopener nofollow">https://hazelcast.com/glossary/directed-acyclic-graph/</a></li>



<li><a href="https://web.archive.org/web/20230106143932/https://towardsdatascience.com/mlops-with-a-feature-store-816cfa5966e9" target="_blank" rel="noreferrer noopener nofollow">https://towards data science . com/mlops-with-a-feature-store-816 CFA 5966 e 9</a></li>



<li><a href="https://web.archive.org/web/20230106143932/https://medium.com/arthur-engineering/picking-a-kubernetes-orchestrator-airflow-argo-and-prefect-83539ecc69b" target="_blank" rel="noreferrer noopener nofollow">https://medium . com/Arthur-engineering/picking-a-kubernetes-orchestrator-air flow-Argo-and-prefect-83539 ECC 69 b</a></li>



<li><a href="https://web.archive.org/web/20230106143932/https://argoproj.github.io/argo-workflows/artifact-visualization/#artifact-types" target="_blank" rel="noreferrer noopener nofollow">https://Argo proj . github . io/Argo-workflows/artifact-visualization/# artifact-types</a></li>



<li><a href="https://web.archive.org/web/20230106143932/https://airflow.apache.org/docs/apache-airflow/stable/concepts/overview.html" target="_blank" rel="noreferrer noopener nofollow">https://air flow . Apache . org/docs/Apache-air flow/stable/concepts/overview . html</a></li>



<li><a href="https://web.archive.org/web/20230106143932/https://spell.ml/blog/orchestrating-spell-model-pipelines-using-prefect-YU3rsBEAACEAmRxp" target="_blank" rel="noreferrer noopener nofollow">https://spell . ml/blog/orchestrating-spell-model-pipelines-using-prefect-YU3rsBEAACEAmRxp</a></li>



<li><a href="https://web.archive.org/web/20230106143932/https://github.com/PrefectHQ/prefect" target="_blank" rel="noreferrer noopener nofollow"> https://github.com/PrefectHQ/prefect </a></li>



<li><a href="https://web.archive.org/web/20230106143932/https://www.datarevenue.com/en-blog/airflow-vs-luigi-vs-argo-vs-mlflow-vs-kubeflow" target="_blank" rel="noreferrer noopener nofollow">https://www . data revenue . com/en-blog/air flow-vs-Luigi-vs-Argo-vs-ml flow-vs-kube flow</a></li>



<li><a href="https://web.archive.org/web/20230106143932/https://hevodata.com/learn/argo-vs-airflow/#w6" target="_blank" rel="noreferrer noopener nofollow">https://hevodata.com/learn/argo-vs-airflow/#w6</a></li>



<li>https://www . data revenue . com/en-blog/what-we-loving-about-perfect</li>



<li><a href="https://web.archive.org/web/20230106143932/https://github.com/PrefectHQ/prefect" target="_blank" rel="noreferrer noopener nofollow"> https://github.com/PrefectHQ/prefect </a></li>



<li><a href="https://web.archive.org/web/20230106143932/https://docs.prefect.io/" target="_blank" rel="noreferrer noopener nofollow"> https://docs.prefect.io/ </a></li>



<li><a href="https://web.archive.org/web/20230106143932/https://medium.com/the-prefect-blog/introducing-the-artifacts-api-b9e5972db043" target="_blank" rel="noreferrer noopener nofollow">https://medium . com/the-prefect-blog/introducing-the-artifacts-API-B9 e 5972 db 043</a></li>



<li>https://medium . com/the-prefect-blog/orchestrate-your-data-science-project-with-prefect-2-0-4118418 FD 7 ce</li>



<li><a href="https://web.archive.org/web/20230106143932/https://www.reddit.com/r/dataengineering/comments/oqbiiu/airflow_vs_prefect/" target="_blank" rel="noreferrer noopener nofollow">https://www . Reddit . com/r/data engineering/comments/oqbiiu/air flow _ vs _ prefect/</a></li>



<li><a href="https://web.archive.org/web/20230106143932/https://medium.com/the-prefect-blog/introducing-the-artifacts-api-b9e5972db043" target="_blank" rel="noreferrer noopener nofollow">https://medium.com/the-prefect-blog/introducing-the-artifacts-api-b9e5972db043</a> </li>



<li><a href="https://web.archive.org/web/20230106143932/https://medium.com/the-prefect-blog/orchestrate-your-data-science-project-with-prefect-2-0-4118418fd7ce" target="_blank" rel="noreferrer noopener nofollow">https://medium.com/the-prefect-blog/orchestrate-your-data-science-project-with-prefect-2-0-4118418fd7ce</a> </li>



<li><a href="https://web.archive.org/web/20230106143932/https://www.reddit.com/r/dataengineering/comments/oqbiiu/airflow_vs_prefect/" target="_blank" rel="noreferrer noopener nofollow">https://www.reddit.com/r/dataengineering/comments/oqbiiu/airflow_vs_prefect/</a></li>
</ol>
        </div>
        
    </div>    
</body>
</html>