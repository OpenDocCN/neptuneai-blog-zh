<html>
<head>
<title>ML Metadata Store: What It Is, Why It Matters, and How to Implement It </title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>ML元数据存储:它是什么，为什么重要，以及如何实现它</h1>
<blockquote>原文：<a href="https://web.archive.org/web/https://neptune.ai/blog/ml-metadata-store#0001-01-01">https://web.archive.org/web/https://neptune.ai/blog/ml-metadata-store#0001-01-01</a></blockquote><div><div class="l-content content-wrapper js-content">
            
<p>大多数找到这个页面的人都想改进他们的建模过程。</p>



<p>但是他们在存储和管理ML模型元数据方面的问题是不同的。</p>



<p>对一些人来说，问题在于杂乱的实验。</p>



<p>其他人已经将第一批模型部署到生产中，但是他们不知道这些模型是如何创建的，也不知道使用了哪些数据。</p>



<p>有些人已经在生产中有了许多模型，但是编排模型A/B测试，切换挑战者和冠军，或者触发、测试和监控再培训管道并不是很好。</p>



<p>如果你认为自己属于这些群体中的一员，或者介于两者之间，我可以告诉你，ML元数据存储可以帮助你完成所有这些事情，还有其他一些事情。</p>



<p>您可能需要将其连接到其他<a href="/web/20230304071956/https://neptune.ai/blog/best-mlops-tools" target="_blank" rel="noreferrer noopener"> MLOps工具</a>或您的CI/CD管道，但它将简化大多数工作流程中的模型管理。</p>



<p>…但实验跟踪、<a href="https://web.archive.org/web/20230304071956/https://neptune.ai/product/model-registry" target="_blank" rel="noreferrer noopener">模型注册、</a>模型存储、模型目录和其他与模型相关的动物也是如此。</p>



<p>那么ML元数据存储到底是什么，它与其他模型有什么不同，它如何帮助您更自信地构建和部署模型？</p>



<p>这就是这篇文章的内容。</p>



<p>另外，如果你是那种喜欢摆弄东西来看看它们是什么的人，你可以在Neptune ML元数据存储库中查看这个<a href="https://web.archive.org/web/20230304071956/https://app.neptune.ai/common/example-project-tensorflow-keras/e/TFKERAS-14/dashboard/summary-6f234f52-6b77-476a-9486-63037655b3be" target="_blank" rel="noreferrer noopener">示例项目。</a></p>



<p>但是首先…</p>







<p>在我们深入ML元数据存储之前，我可能应该告诉你我所说的“机器学习元数据”是什么意思。</p>



<p>当你做机器学习时，总会涉及到一个模型。这就是机器学习。</p>



<p>它可能是一个经典的监督模型，如lightGBM分类器、强化学习代理、贝叶斯优化算法或其他任何东西。</p>



<p>但它需要一些数据，通过一些数字运行，并输出一个决定。</p>



<p>…将它投入生产需要大量的工作。</p>



<p>您必须:</p>



<ul>
<li>火车，</li>



<li>调，</li>



<li>调试，</li>



<li>评估，</li>



<li>解释一下，</li>



<li>并将其与基线进行比较。</li>
</ul>



<p>如果您的模型通过了研究阶段，您还必须:</p>



<ul>
<li>包装，</li>



<li>部署，</li>



<li>监视器，</li>



<li>重新训练它。</li>
</ul>



<p>很多步骤。</p>



<p>现在你可能知道了，你不会线性地经历这些步骤，你不会经历一次。</p>



<p>修复数据、修复模型、修复预处理以及所有这些好的东西需要大量的迭代。</p>





<p>这些步骤中的每一步都会产生关于模型的元信息，或者许多人所说的ML模型元数据。</p>



<p>这些可能是:</p>



<ul>
<li>训练参数，</li>



<li>评估指标，</li>



<li>预测实例，</li>



<li>数据集版本，</li>



<li>测试管道输出，</li>



<li>对模型权重文件的引用，</li>



<li>以及其他与模型相关的东西。</li>
</ul>



<p>这些信息有助于您了解您的模型。</p>



<p>它有助于您了解:</p>



<ul>
<li>模型的特定版本在哪里，并快速回滚到以前的版本</li>



<li>模型是如何构建的，是谁创建的</li>



<li>它在训练中使用了哪些数据/参数/代码</li>



<li>新的实验或模型版本与基线或以前的生产模型相比如何</li>



<li>它在各个评估阶段的表现如何</li>
</ul>



<p>当你的模型对某人很重要时，当他们接触用户或帮助客户做决定时，你最好多了解他们。</p>



<p>为什么？</p>



<p>因为当你的模型工作时一切都很好，但当它停止工作时，你让它再次工作的唯一机会是理解它为什么失败。</p>



<p>但是你通常不会平等地关心所有的模型元数据。</p>



<p>对于某些工作流，实验元数据至关重要，对于某些工作流，它是生产模型元数据，对于某些工作流，它是再培训管道元数据。</p>



<p>由您来决定您和您的工作流程需要什么。</p>



<p>为了帮助您了解您可能关心的内容，让我们列出这些类别中的示例元数据。</p>



<h3>关于实验和模型训练运行的元数据</h3>



<p>在实验过程中，你通常关心的是<a href="/web/20230304071956/https://neptune.ai/blog/ml-model-debugging-and-tools" target="_blank" rel="noreferrer noopener">调试</a>、<a href="/web/20230304071956/https://neptune.ai/blog/the-best-tools-to-visualize-metrics-and-hyperparameters-of-machine-learning-experiments" target="_blank" rel="noreferrer noopener">可视化</a>、<a href="/web/20230304071956/https://neptune.ai/blog/ml-model-monitoring-best-tools" target="_blank" rel="noreferrer noopener">监控</a>你的模型训练，以获得最佳模型。</p>



<p>为此，记录ML运行期间发生的任何事情都是一个好的做法，包括:</p>



<ul>
<li><strong>数据版本:</strong>参考数据集、md5哈希、数据集样本，了解哪些数据用于训练模型</li>



<li><strong>环境配置:</strong> requirements.txt，conda.yml，Dockerfile，Makefile了解如何重建模型被训练的环境</li>



<li><strong>代码版本:</strong>获取提交的SHA或代码的实际快照，以了解使用了什么代码来构建模型</li>



<li><strong>超参数:</strong>管道的特征预处理步骤的配置，模型训练，以及必要时再现过程的推理</li>



<li><strong>训练指标和损失</strong>:单值和学习曲线，看看继续训练是否有意义</li>



<li><strong>记录硬件指标:</strong> CPU、GPU、TPU、内存看你的模型在训练/推理过程中消耗了多少</li>



<li><strong>评估和测试指标:</strong>测试和验证集上的f2、acc、roc，以了解您的模型表现如何</li>



<li><strong>绩效可视化:</strong> ROC曲线、混淆矩阵、PR曲线，深入了解错误</li>



<li><strong>模型预测:</strong>查看实际预测并了解超出指标的模型性能</li>



<li>…以及大约100万个与你的领域相关的其他东西</li>
</ul>


<div class="wp-block-image">
<figure class="aligncenter size-large"><a href="https://web.archive.org/web/20230304071956/https://app.neptune.ai/o/common/org/project-cv/e/PROJCV-103/dashboard/variety-metadata-d78dd5d4-dc58-4488-baa0-0bbe1017ceec" target="_blank" rel="noopener"><img decoding="async" src="../Images/bf0e762f7ad956d3dab119534c264d6d.png" alt="Metadata dashboard experiments" class="wp-image-51513" data-recalc-dims="1" data-original-src="https://web.archive.org/web/20230304071956im_/https://i0.wp.com/neptune.ai/wp-content/uploads/2022/10/Metadata-dashboard-experiments.png?ssl=1"/></a><figcaption class="wp-element-caption"><em>Example of model training runs metadata | </em><a href="https://web.archive.org/web/20230304071956/https://app.neptune.ai/o/common/org/project-cv/e/PROJCV-103/dashboard/variety-metadata-d78dd5d4-dc58-4488-baa0-0bbe1017ceec" target="_blank" rel="noreferrer noopener nofollow"><em>Source</em></a></figcaption></figure></div>


<h3>关于工件的元数据</h3>



<p>除了实验和模型训练运行，在ML项目中还使用了一个概念:<strong>工件</strong>。这些运行的输入或输出可以在项目的许多运行中使用。工件在项目过程中会发生变化，在ML生命周期的某个时刻，您通常会有同一个工件的多个版本。</p>



<p>工件可以是数据集、模型、预测和其他类似文件的对象。对于您可能想要记录的工件:</p>



<ul>
<li><strong>引用:</strong>数据集或模型的路径(s3存储桶，文件系统)</li>



<li><strong> Version: </strong> Dataset或model md5 hash让你快速看出区别</li>



<li><strong>预览:</strong>数据集/预测预览(表头，图像文件夹快照)查看该数据集的内容</li>



<li><strong>描述:</strong>关于神器的附加信息将帮助你理解它是什么。例如，您可能想要记录表格数据集工件的列名</li>



<li>作者:谁在何时创建和修改了这个工件</li>



<li>许多其他的事情可能是你的项目特有的，比如数据集的大小，ML模型的类型等等</li>
</ul>


<div class="wp-block-image">
<figure class="aligncenter size-large"><a href="https://web.archive.org/web/20230304071956/https://app.neptune.ai/o/common/org/example-project-tensorflow-keras/e/TFKERAS-13/dashboard/artifacts-9cc55d46-8e2b-476e-8ce7-f30ff1b01549" target="_blank" rel="noopener"><img decoding="async" src="../Images/385569d5c206a58ae761b3973d881c79.png" alt="Example of artifacts metadata" class="wp-image-50775" data-recalc-dims="1" data-original-src="https://web.archive.org/web/20230304071956im_/https://i0.wp.com/neptune.ai/wp-content/uploads/2022/10/Metadata-dashboard-artifacts.png?ssl=1"/></a><figcaption class="wp-element-caption"><em>Example of artifacts metadata | </em><a href="https://web.archive.org/web/20230304071956/https://app.neptune.ai/o/common/org/example-project-tensorflow-keras/e/TFKERAS-13/dashboard/artifacts-9cc55d46-8e2b-476e-8ce7-f30ff1b01549" target="_blank" rel="noreferrer noopener"><em>Source</em></a></figcaption></figure></div>


<h3>关于已训练模型的元数据</h3>



<p>经过训练的模型在ML项目中是如此重要的一类工件，以至于我决定给它们一个单独的类别。</p>



<p>一旦您的模型经过训练并准备好投入生产，您的需求就会从调试和可视化转变为知道如何部署模型包、对其进行版本化，以及在生产中监控性能。</p>



<p>因此，您可能希望记录的ML元数据是:</p>



<ul>
<li><strong>模型包:</strong>模型二进制文件或者模型资产的位置</li>



<li><strong>模型版本:</strong>代码、数据集、超参数、环境版本</li>



<li><strong>评估记录:</strong>一段时间内发生的所有测试/验证评估的历史记录</li>



<li><strong>实验版本:</strong>链接到记录的模型训练(和再训练)运行以及与该模型版本相关的其他实验</li>



<li>模型创建者/维护者:谁构建了这个模型，如果/当出现问题时，你应该问谁</li>



<li><strong>下游数据集/工件:</strong>数据集、模型和其他下游用于构建模型的资产的引用。这对于一些组织的法规遵从性来说是必不可少的。</li>



<li><strong>漂移相关指标:</strong>所有“实时”生产的数据漂移、概念漂移、性能漂移</li>



<li><strong>硬件监控:</strong>生产中消耗的CPU/GPU/TPU/内存。</li>



<li>当你的模型向世界发送预测时，还有什么能让你晚上睡觉的吗</li>
</ul>



<p>为了管理所有的元数据，你可以使用模型注册表、<a href="/web/20230304071956/https://neptune.ai/blog/ml-model-monitoring-best-tools" target="_blank" rel="noreferrer noopener">生产模型监控工具</a>、<a href="/web/20230304071956/https://neptune.ai/blog/best-ml-experiment-tracking-tools" target="_blank" rel="noreferrer noopener">实验跟踪工具</a>，或者软件监控解决方案。</p>


<div class="wp-block-image">
<figure class="aligncenter size-large"><a href="https://web.archive.org/web/20230304071956/https://i0.wp.com/neptune.ai/wp-content/uploads/2022/10/Metadata-dashboard-trained-model.png?ssl=1" target="_blank" rel="noopener"><img decoding="async" src="../Images/359c4013e66cb88cf224724873c57db7.png" alt="Metadata-dashboard-trained-model" class="wp-image-50806" data-recalc-dims="1" data-original-src="https://web.archive.org/web/20230304071956im_/https://i0.wp.com/neptune.ai/wp-content/uploads/2022/10/Metadata-dashboard-trained-model.png?ssl=1"/></a><figcaption class="wp-element-caption"><em>Example of trained model metadata </em></figcaption></figure></div>


<h3>关于管道的元数据</h3>



<p>您可能处于这样一个点，您的ML模型在一个自动触发的管道中接受训练:</p>



<ul>
<li>当性能下降到特定阈值以下时</li>



<li>当新的标记数据到达数据库时</li>



<li>当一个特征分支被合并开发时</li>



<li>或者干脆每周一次</li>
</ul>



<p>您可能有一些CI/CD工作流连接到管道和编排工具，如Airflow、<a href="/web/20230304071956/https://neptune.ai/vs/kubeflow" target="_blank" rel="noreferrer noopener"> Kubeflow </a>或Kedro。在这些情况下，每个触发器开始执行计算DAG(有向无环图),其中每个节点产生元数据。</p>



<section id="blog-intext-cta-block_ca2527a407e6fded8e909702c189fa0e" class="block-blog-intext-cta  c-box c-box--default c-box--dark c-box--no-hover c-box--standard ">

            
    
            <p><a href="/web/20230304071956/https://neptune.ai/blog/best-workflow-and-pipeline-orchestration-tools">最佳工作流和管道编排工具</a> <br/> <a href="/web/20230304071956/https://neptune.ai/blog/best-mlops-tools" target="_blank" rel="noopener">最佳MLOps工具</a> <br/> <a href="https://web.archive.org/web/20230304071956/https://docs.neptune.ai/integrations-and-supported-tools/automation-pipelines/kedro" target="_blank" rel="noopener"> Kedro-Neptune集成</a>(允许您过滤、比较、显示和组织管道和节点中生成的ML元数据)</p>
    
    </section>


<div class="wp-block-image">
<figure class="aligncenter size-full is-resized"><a href="https://web.archive.org/web/20230304071956/https://i0.wp.com/neptune.ai/wp-content/uploads/2022/10/Pipeline-visualization-Kedro-Viz.png?ssl=1"><img decoding="async" loading="lazy" src="../Images/7cfdf0c072dace762100a8bfb8b33f95.png" alt="Pipeline visualization Kedro Viz" class="wp-image-50808" data-recalc-dims="1" data-original-src="https://web.archive.org/web/20230304071956im_/https://i0.wp.com/neptune.ai/wp-content/uploads/2022/10/Pipeline-visualization-Kedro-Viz.png?resize=349%2C654&amp;ssl=1"/></a><figcaption class="wp-element-caption"><em>Pipeline visualization in Kedro-Viz | </em><a href="https://web.archive.org/web/20230304071956/https://kedro.readthedocs.io/en/stable/03_tutorial/06_visualise_pipeline.html"><em>Source</em></a></figcaption></figure></div>


<p>在这种情况下，对元数据的需求与实验或模型有所不同。高效计算管道(DAG)需要此元数据:</p>



<ul>
<li><strong>输入和输出步骤</strong>:关于什么进入一个节点，什么从一个节点出来，以及是否所有的输入步骤都已完成的信息</li>



<li><strong>缓存输出:</strong>引用来自管道的中间结果，以便您可以从图中的某个点继续计算</li>
</ul>







<p>ML元数据存储是ML模型相关元数据的“存储”。在这个地方，您可以获得您构建和部署的任何ML模型所需的任何东西。</p>



<p>更具体地说，ML元数据存储使您能够:</p>



<ul>
<li>日志，</li>



<li>店，</li>



<li>显示，</li>



<li>监视器，</li>



<li>比较一下，</li>



<li>组织起来，</li>



<li>过滤器，</li>



<li>并查询所有与模型相关的元数据。</li>
</ul>



<p>简而言之，它给你一个<strong>单一的地方来管理所有关于实验、工件、模型和管道的ML元数据。</strong></p>



<p>你可以把它想象成一个数据库和一个专门用来管理ML模型元数据的用户界面。它通常附带一个API或SDK(客户端库)来简化ML元数据的日志记录和查询。</p>


<div class="wp-block-image">
<figure class="aligncenter size-large"><img decoding="async" src="../Images/952146f2fdd1ac38c05bb20fad0319f0.png" alt="Metadata_dashboard" class="wp-image-37505" data-recalc-dims="1" data-original-src="https://web.archive.org/web/20230304071956im_/https://i0.wp.com/neptune.ai/wp-content/uploads/2022/10/Metadata_dashboard.jpg?ssl=1"/><figcaption class="wp-element-caption"><em>Metadata store – a database and a user interface | </em><a href="/web/20230304071956/https://neptune.ai/product" target="_blank" rel="noreferrer noopener"><em>Source </em></a></figcaption></figure></div>


<p>等等，它是一个知识库/目录还是什么？</p>



<p>是的，不，算是吧。让我解释一下。</p>



<h3>存储库vs注册表vs存储</h3>



<p>在ML元数据的上下文中，所有这些基本上都是为存储元数据而创建的数据库，它们的功能略有不同。</p>



<p><strong>元数据库</strong>是一个<a href="https://web.archive.org/web/20230304071956/https://en.wikipedia.org/wiki/Metadata_repository" target="_blank" rel="noreferrer noopener nofollow">的地方，在这里你存储元数据对象以及这些对象之间的所有关系</a>。您可以使用GitHub作为一个存储库，将所有评估指标保存为一个文件，该文件是通过提交后钩子创建的，或者将训练期间的参数和损失记录到一个<a href="/web/20230304071956/https://neptune.ai/product/experiment-tracking" target="_blank" rel="noreferrer noopener">实验跟踪工具</a>中，该工具在本文中实际上是一个存储库。</p>



<p><strong>元数据注册中心</strong>是一个为重要元数据设置“检查点”的地方。您注册了一些您关心的东西，并希望以后可以方便地找到和访问它。一个<a href="https://web.archive.org/web/20230304071956/https://doveltech.com/innovation/registries-vs-repositories-and-standards-vs-products/" target="_blank" rel="noreferrer noopener nofollow">注册表总是为特定的东西服务的。没有通用注册中心</a>。例如，您可能有一个<a href="/web/20230304071956/https://neptune.ai/product/model-registry" target="_blank" rel="noreferrer noopener">模型注册中心</a>，它列出了所有的生产模型，并引用了ML元数据存储库，实际的模型相关元数据就在那里。</p>



<p><strong>元数据存储</strong>是一个你去“购买”元数据的地方。对于ML模型，它是一个中心位置，在这里您可以找到所有的模型、实验、工件和管道相关的元数据。你越是需要来到“商店”，搜索元数据“产品”，比较它们，“购买”它们，它就越是一个商店而不是一个储存库。</p>



<p>所以在ML模型元数据的情况下:</p>



<ul>
<li>你有许多不同的元数据:许多模型，许多版本，甚至更多的实验和每个实验的元数据</li>



<li><strong>你要经常查找和比较:</strong>选择最佳模型训练运行或调试生产模型</li>



<li><strong>您希望经常记录和访问它:</strong>记录实验的训练指标或获取打包的模型</li>
</ul>



<p>称它为“存储”比称它为“存储库”或“注册表”更有意义，但是和软件一样，这要视情况而定。</p>



<p>现在，如果我告诉你实际上有两种风格的ML元数据存储呢？</p>



<h3>管道优先与模型优先的ML元数据存储</h3>



<p>随着你的ML组织的成熟，当训练模型发生在一些自动化的、协调的管道中时，你会到达一个点。</p>



<p>此时，运行实验、培训和再培训生产模型总是与执行管道相关联。</p>



<p>您的ML元数据存储可以:</p>



<ul>
<li>将<strong>管道视为一级对象</strong>，并将生成的模型和实验与它们相关联。</li>



<li>将<strong>模型和实验视为一级对象</strong>，将管道视为一种执行模式。</li>
</ul>



<p>根据您放在中心的内容，您的ML元数据存储将做稍微不同的事情。</p>



<p>如果你关注过程，模型构建管道，你会得到类似于<a href="https://web.archive.org/web/20230304071956/https://www.tensorflow.org/tfx/guide/mlmd" target="_blank" rel="noreferrer noopener nofollow"> MLMD </a>的东西，它驱动管道和编排工具，如<a href="https://web.archive.org/web/20230304071956/https://www.kubeflow.org/" target="_blank" rel="noreferrer noopener nofollow"> Kubeflow </a>和<a href="https://web.archive.org/web/20230304071956/https://www.tensorflow.org/tfx" target="_blank" rel="noreferrer noopener nofollow"> TensorFlow Extended (TFX) </a>。</p>



<p>如果你关注输出，模型，你会得到类似于<a href="https://web.archive.org/web/20230304071956/https://mlflow.org/" target="_blank" rel="noreferrer noopener nofollow"> MLflow </a>或者<a href="/web/20230304071956/https://neptune.ai/product" target="_blank" rel="noreferrer noopener"> Neptune </a>的东西。</p>







<p>哪个更好？</p>



<p>我想没有人知道，真的，但是ML社区的人们正在积极地测试这两者。</p>



<p>正如管道优先ML元数据商店的MLMD产品经理Ben Mathes解释的那样:</p>



<p><em>“答案背后有一些很精彩的HCI和产品策略观点。</em></p>



<p>在ML行业中有多种努力来解决跟踪所有ML工件的问题:模型、数据集、特征等。与经典软件工程迭代跟踪代码的多种方式相同(像subversion这样的集中回购，像git这样的分散回购，等等)。)，ML engineering正在发展跟踪ML Engineering的最佳方式。</p>



<p>在我看来，ML-Flow是一种模型优先的观点。如果你熟悉的话，这有点像RDBMs中的星型模式。与TFX的管道优先观点相反。MLMD可以成为TFX管道记录每次运行的DAG历史的一部分。MLFlow和MLMD都在积极开发中，所以这些意见是移动的目标🙂</p>



<p>理论上，每个视图(模型优先或管道优先)都可以从另一个视图中恢复。从管道优先视图中恢复模型优先视图更容易，因为它只需要隐藏信息(管道的其余部分)。但是模型优先视图可能不会首先存储模型之外的额外信息，如其训练数据、分析、与在相同管道上训练的其他模型的比较、模型的完整血统等。</p>



<p>所以MLFlow从一个不同于ML元数据的角度来看待这个问题。管道优先，而不是模型优先。我们谷歌发现，让管道成为一等公民更有用。"</p>



<p>“但是功能商店呢？”</p>



<p>好了，我们开始吧。</p>



<h3>ML元数据存储与功能存储</h3>



<p>ML元数据存储类似于功能存储吗？是不是同样的东西只是用在不同的地方？</p>



<p>简单的回答是否定的(详细的回答也是否定的🙂 ).</p>



<p>Feature store是一种ML设计模式和实现它的一类工具，它抽象了特征生成，并允许您:</p>



<p>以同样的方式创建和访问特征</p>



<p>确保您在生产中使用的功能与培训中使用的功能相同</p>



<p>重复使用特征进行模型构建和分析</p>



<p>如果你想了解更多关于功能商店的细节，可以看看泰克顿的人写的一篇文章，他创建了最好的功能商店之一。</p>



<p>他们比我更清楚如何解释这件事。</p>



<p>但是为了便于讨论，请务必记住，功能存储侧重于:</p>



<p>一致的特性工程(从开发环境到生产环境)</p>



<p>轻松访问各种功能</p>



<p>了解特征生成过程</p>



<p>正如我前面所解释的，ML元数据存储处理模型元数据，并关注:</p>



<p>发现、可视化和比较实验</p>



<p>模型传承和版本控制</p>



<p>模型训练和实验的可重复性</p>



<p>轻松访问包装模型</p>



<p>但是模型版本化的一部分是知道哪些特性被用来创建它，对吗？</p>



<p>正确。</p>



<p>这就是为什么您可以将ML元数据存储连接到要素存储，并记录对用于训练的要素的引用。</p>



<p>这些工具应该很好地协同工作，以改进您的建模工作流程。</p>







<p>这给我们带来了最重要的问题…</p>







<p>现在您已经知道了它是什么，让我们深入了解它如何帮助您自信地管理模型。</p>



<p>根据您的工作流是侧重于实验还是生产，您从ML元数据存储中获得的需求和价值可能是不同的。</p>



<p>让我们来谈谈这两个极端。</p>



<h3>为什么要存储机器学习实验的元数据？</h3>



<p>在实验和模型开发过程中，您最关心的是找到一个足够好的模型。</p>



<p>然而，什么是足够好的呢？</p>



<p>它可能是一个比随机猜测稍微好一点的模型，或者它可能是这个问题的最先进的(SOTA)。和往常一样，这要视情况而定，但是要实现这一点，您通常需要运行许多迭代。</p>



<p>为了在每次迭代中改进您的模型，您需要:</p>



<ul>
<li><strong>知道之前尝试过什么</strong></li>



<li><strong>将</strong>新想法与基线或当前最佳模型进行比较</li>



<li><strong>可视化模型结果，</strong>执行错误分析，看看哪里可以改进</li>



<li>能够重现你之前尝试过的想法</li>



<li><strong>调试模型和/或基础设施的问题</strong></li>
</ul>



<p>ML元数据存储通过为您提供以下功能来帮助您完成所有这些工作:</p>



<ul>
<li>在一个地方保存所有实验和ML模型元数据的跟踪记录</li>



<li>搜索/过滤界面找到你关心的实验</li>



<li>可视化和比较实验的工具</li>



<li>接口来记录/显示在调试过程中可能有用的所有元数据</li>
</ul>


<div class="wp-block-image">
<figure class="aligncenter size-full"><a href="https://web.archive.org/web/20230304071956/https://app.neptune.ai/o/common/org/example-project-pytorch/experiments?compare=EwBgNAjGxgLEA&amp;split=bth&amp;dash=charts&amp;viewId=64eb9112-34ca-495c-a5cf-cd5e48e35864" target="_blank" rel="noopener"><img decoding="async" src="../Images/910898e3ad4f0c33e2e5cc78eb794012.png" alt="Product_Dashboard" class="wp-image-45639" data-recalc-dims="1" data-original-src="https://web.archive.org/web/20230304071956im_/https://i0.wp.com/neptune.ai/wp-content/uploads/2022/10/Product_Dashboard.png?ssl=1"/></a><figcaption class="wp-element-caption"><em>Metadata store dashboard | </em><a href="https://web.archive.org/web/20230304071956/https://app.neptune.ai/o/common/org/example-project-pytorch/experiments?compare=EwBgNAjGxgLEA&amp;split=bth&amp;dash=charts&amp;viewId=64eb9112-34ca-495c-a5cf-cd5e48e35864"><em>Source</em></a></figcaption></figure></div>


<h3>为什么要存储关于生产机器学习模型的元数据？</h3>



<p>一旦你的模型投入生产，你的兴趣就会发生很大变化。</p>



<p>您有一个足够好的经过训练的模型版本，但是您想确信您可以在业务应用程序中使用它。具体来说，您可能希望:</p>



<ul>
<li><strong>了解模型是如何建造的。</strong>谁造的，用了哪些代码、数据、参数、环境版本来训练它。</li>



<li><strong>包装</strong>模型，以便有人可以在不知道里面是什么的情况下使用。</li>



<li><strong>从您的生产环境中轻松访问</strong>打包模型的当前和以前版本。</li>



<li><strong>检查、监控并提醒</strong>模型输入/输出分布的任何意外变化。</li>



<li><strong>监控硬件</strong>随时间的消耗。</li>



<li><strong>在新模型版本部署到生产之前，对其进行测试和批准</strong>。</li>



<li><strong>拥有自动化的CI/CD管道</strong>用于测试和培训模型。</li>



<li>更多</li>
</ul>







<p>ML元数据存储可以使它变得更容易，因为它提供了:</p>



<ul>
<li>接口为团队建立模型版本化和打包的协议</li>



<li>能够通过CLI和SDK以您在生产中使用的语言查询/访问模型版本</li>



<li>记录硬件、数据/概念漂移、CI/CD管道的示例预测、再培训工作和生产模型的地方</li>



<li>接口来设置由主题专家、生产团队或自动检查进行批准的协议</li>
</ul>


<div class="wp-block-image">
<figure class="aligncenter size-full"><a href="https://web.archive.org/web/20230304071956/https://i0.wp.com/neptune.ai/wp-content/uploads/2022/10/Use-computational-resources.png?ssl=1"><img decoding="async" src="../Images/8893dddaa952032773416c91c698d498.png" alt="Use computational resources" class="wp-image-45168" data-recalc-dims="1" data-original-src="https://web.archive.org/web/20230304071956im_/https://i0.wp.com/neptune.ai/wp-content/uploads/2022/10/Use-computational-resources.png?ssl=1"/></a><figcaption class="wp-element-caption"><em>Monitoring in a metadata store</em></figcaption></figure></div>


<h3>你需要一个ML元数据存储吗？</h3>



<p>但是知道了这些，你真的需要一个吗？</p>



<p>你能仅仅用一个电子表格、文件夹结构、tensorboard截图和一个S3桶就搞定吗？</p>



<p>是的，当然，有时候，但这有什么意义呢？</p>



<p>一位智者曾经告诉我，每一个商业问题都可以通过一个电子表格、google drive和大量的动力来解决。</p>



<p>我真心相信他是对的。</p>



<p>真正的问题是，为什么要这么做。</p>







<p><strong>为什么要在ML模型元数据簿记上浪费时间</strong>当您可以:</p>



<p>改进模型的工作</p>



<p>自动化、测试或记录管道的某些部分</p>



<p>找出ML要解决的下一个问题</p>



<p>向用户介绍您的解决方案</p>



<p>或者坦白地说，在youtube上看《猫》</p>



<p>所有这些都比编写胶水代码或在谷歌表单中输入参数更能利用你的时间…</p>



<p>但是你可以说:“我可以写脚本来自动化所有这些”。</p>



<p>嗯，好吧，我们来谈谈实现。</p>







<h3>构建vs维护vs购买</h3>



<p>这是一个古老的难题。从事软件工作的人在职业生涯中会面临很多次。</p>



<p>要做出决定，您应该:</p>



<ul>
<li>了解你实际上在解决什么问题</li>
</ul>



<ul>
<li>在构建之前，看看是否有工具可以解决这个问题</li>



<li>评估构建、维护和定制它需要多少时间</li>



<li>不要低估为此付出的努力</li>
</ul>



<p>但是，让我们具体看看您在ML元数据存储上下文中的选项。</p>



<h4>自己建立一个系统</h4>



<p id="separator-block_f34fd1f58aadd0c7734994597c068766" class="block-separator block-separator--10">赞成的意见</p>



<div id="medium-table-block_d120ea14551a5b8b0ad86fff35346451" class="block-medium-table c-table__outer-wrapper ">

    <table class="c-table">
                    <thead class="c-table__head">
            <tr>
                                    <td class="c-item">
                        <p class="c-item__inner">骗局</p>
                    </td>
                                    <td class="c-item">
                        <p class="c-item__inner">                                                      </p>
                    </td>
                            </tr>
            </thead>
        
        <tbody class="c-table__body">

                    
                <tr class="c-row">

                    
                        <td class="c-ceil">                                                      </td>

                    
                        <td class="c-ceil"><div class="c-ceil__inner"> <p>你可以完全为你的用例</p> </div>创建它</td>

                    
                </tr>

            
                <tr class="c-row">

                    
                        <td class="c-ceil">您可以完全根据您的用例来创建它</td>

                    
                        <td class="c-ceil">你必须建立和维护基础设施</td>

                    
                </tr>

            
                <tr class="c-row">

                    
                        <td class="c-ceil">你可以随意改进/改变它</td>

                    
                        <td class="c-ceil">你必须为其他人记录下来</td>

                    
                </tr>

            
                <tr class="c-row">

                    
                        <td class="c-ceil">
                            <p class="c-ceil__inner">                                                      </p>
                        </td>

                    
                        <td class="c-ceil">                                                                                                                                 </td>

                    
                </tr>

            
                <tr class="c-row">

                    
                        <td class="c-ceil">
                            <p class="c-ceil__inner"><div class="c-ceil__inner"> <p>你必须实现改进并与其他工具集成</p> </div></p>
                        </td>

                    
                        <td class="c-ceil">您必须实现改进并与其他工具集成</td>

                    
                </tr>

            
                <tr class="c-row">

                    
                        <td class="c-ceil">
                            <p class="c-ceil__inner"><div class="c-ceil__inner"> <p>软件不工作是你的错</p> </div></p>
                        </td>

                    
                        <td class="c-ceil">当软件不工作时，那是你的错</td>

                    
                </tr>

                    
        </tbody>
    </table>

</div>



<p id="separator-block_231534151b1d650ce3a955ae008d3c4e" class="block-separator block-separator--20">你可以自己建造整个东西。为元数据设置一个数据库，创建一个可视化界面和一个python包来记录数据。</p>



<p>它肯定会完美地工作。</p>



<p>当元数据的数量变得太大，数据库无法处理时，您可以对其进行优化。你可以设置备份和分片，使其防弹。</p>



<p>如果您创建的笔记本中缺少可视化功能，您可以设置适当的web界面，并实现与数据库的通信。然后，优化它，智能地处理数据负载，并学习一些设计，使它看起来很好。</p>



<p>您可以实现与ML框架的集成，以简化日志记录。如果日志记录部分降低了您的训练脚本的速度，您可以实现一些与数据库的异步通信，以便在单独的线程中记录更大的元数据对象，如图像或音频。</p>



<p>当人们加入你的团队并喜欢你所创建的东西时，你可以创建例子和文档来帮助他们使用它，并随着每一次改进而更新它。</p>



<p>你可以，你可以，但是你的工作是实现和维护一些元数据簿记工具吗？</p>



<p>有时没有其他办法，因为你的设置是超级定制的，你解决的问题与其他人的问题如此不同，以至于你必须这样做。</p>



<p>其他99.6%的时候，你可以使用别人开发的工具，专注于你应该首先解决的问题。我想是和曼梯·里有关的。</p>



<p>保持开源</p>



<h4>赞成的意见</h4>



<p id="separator-block_f34fd1f58aadd0c7734994597c068766" class="block-separator block-separator--10">骗局</p>



<div id="medium-table-block_15e82521faf939432d457714ddc90d99" class="block-medium-table c-table__outer-wrapper ">

    <table class="c-table">
                    <thead class="c-table__head">
            <tr>
                                    <td class="c-item">
                        <p class="c-item__inner">                                                      </p>
                    </td>
                                    <td class="c-item">
                        <p class="c-item__inner"><div class="c-ceil__inner"> <p>你要建立和维护基础设施</p> </div></p>
                    </td>
                            </tr>
            </thead>
        
        <tbody class="c-table__body">

                    
                <tr class="c-row">

                    
                        <td class="c-ceil">你必须建立和维护基础设施</td>

                    
                        <td class="c-ceil"><div class="c-ceil__inner"> <p>你不用实现它</p> </div></td>

                    
                </tr>

            
                <tr class="c-row">

                    
                        <td class="c-ceil"><div class="c-ceil__inner"> <p>你要根据自己的需求调整</p> </div></td>

                    
                        <td class="c-ceil"><div class="c-ceil__inner"> <p>文档和社区支持已经存在</p> </div></td>

                    
                </tr>

            
                <tr class="c-row">

                    
                        <td class="c-ceil"><div class="c-ceil__inner"> <p>你必须依靠社区的支持</p> </div></td>

                    
                        <td class="c-ceil"><div class="c-ceil__inner"> <p>其他人正在创造你可能关心的改进</p> </div></td>

                    
                </tr>

            
                <tr class="c-row">

                    
                        <td class="c-ceil"><div class="c-ceil__inner"> <p>你可以推出新功能，但可能必须自己实现</p> </div></td>

                    
                        <td class="c-ceil">                                                                                                                                 </td>

                    
                </tr>

            
                <tr class="c-row">

                    
                        <td class="c-ceil">
                            <p class="c-ceil__inner">当软件不工作时，那是你的错</p>
                        </td>

                    
                        <td class="c-ceil">                                                                                                                                 </td>

                    
                </tr>

            
                <tr class="c-row">

                    
                        <td class="c-ceil">
                            <p class="c-ceil__inner">项目可能会被创建者/维护者/社区放弃</p>
                        </td>

                    
                        <td class="c-ceil"> </td>

                    
                </tr>

                    
        </tbody>
    </table>

</div>



<p id="separator-block_231534151b1d650ce3a955ae008d3c4e" class="block-separator block-separator--20">这通常是一个好的选择，因为您想要的许多特性已经实现了。您可以看到它是如何完成的，并在需要的地方扩展功能。</p>



<p>使用该工具的文档和社区可以帮助您。你可以叉回购，并感到安全，该工具不会消失。</p>



<p>说真的，这通常是一个好的选择，但是有<strong>一些事情需要考虑</strong>。</p>



<p>一个问题是，通常您仍然需要自己设置和维护它。你必须处理备份，后端数据库的自动伸缩，以及所有这些事情。</p>



<p>另一件事是，即使社区就在那里，当你有问题时，他们也不一定会帮助你。你可能要等几个星期才能得到GitHub问题的答案。</p>



<p>第三，如果缺少了什么，你实际上需要继续下去，花一些时间去实现它。</p>



<p>我的观点是，使用开源软件，你不需要为订阅或许可付费，但它并不完全免费。您仍然需要支付:</p>



<p>托管它的基础设施</p>



<p>您或您的团队花费在维护和扩展软件上的时间</p>



<ul>
<li>你或你的团队花在解决问题和寻找解决方案上的时间。</li>



<li>不是说不好。只是需要考虑和顾及的事情。</li>



<li>你可以把你投入到建立基础设施、维护、修复和扩展项目的时间花在其他事情上，比如做ML。</li>
</ul>



<p>购买解决方案</p>



<p>赞成的意见</p>



<h4>骗局</h4>



<p id="separator-block_f34fd1f58aadd0c7734994597c068766" class="block-separator block-separator--10"><div class="c-ceil__inner"> <p>你不用实现它</p> </div></p>



<div id="medium-table-block_551507269497c105162937882ddeb3fc" class="block-medium-table c-table__outer-wrapper ">

    <table class="c-table">
                    <thead class="c-table__head">
            <tr>
                                    <td class="c-item">
                        <p class="c-item__inner">你不必实现它</p>
                    </td>
                                    <td class="c-item">
                        <p class="c-item__inner">                                                      </p>
                    </td>
                            </tr>
            </thead>
        
        <tbody class="c-table__body">

                    
                <tr class="c-row">

                    
                        <td class="c-ceil"><div class="c-ceil__inner"> <p>文档和支持由厂商</p> </div>提供</td>

                    
                        <td class="c-ceil"><div class="c-ceil__inner"> <p>您可能无法自己修复错误/做出改进，供应商修复它们的速度可能会很慢</p> </div></td>

                    
                </tr>

            
                <tr class="c-row">

                    
                        <td class="c-ceil">您可能无法自己修复bugs进行改进，供应商修复它们的速度可能会很慢</td>

                    
                        <td class="c-ceil">基础设施已经存在(对于托管选项)</td>

                    
                </tr>

            
                <tr class="c-row">

                    
                        <td class="c-ceil">公司可能会退出市场</td>

                    
                        <td class="c-ceil">当您需要功能时，您可以请求它们</td>

                    
                </tr>

            
                <tr class="c-row">

                    
                        <td class="c-ceil"><div class="c-ceil__inner"><p/></div></td>

                    
                        <td class="c-ceil">
                            <p class="c-ceil__inner">                                                                                                                                 </p>
                        </td>

                    
                </tr>

            
                <tr class="c-row">

                    
                        <td class="c-ceil"> </td>

                    
                        <td class="c-ceil">
                            <p class="c-ceil__inner">实际上，许多开源项目都有企业版，你可以付费获得支持或托管版本。</p>
                        </td>

                    
                </tr>

                    
        </tbody>
    </table>

</div>



<p id="separator-block_231534151b1d650ce3a955ae008d3c4e" class="block-separator block-separator--20">所以，是的，你可以花钱请人来:</p>



<p>托管解决方案并扩展基础架构</p>



<p>维护软件</p>



<p>为您提供正常运行的保证，并在出现问题时解决问题</p>



<ul>
<li>支持你和你的团队</li>



<li>改进和扩展产品，以帮助您解决您的用例</li>



<li>专注于做ML的事情。</li>



<li>当然，事情并非一帆风顺。</li>



<li>您可能仍然会遇到错误，等待数周的改进，或者产品背后的公司可能会破产。</li>
</ul>



<p>但是这仍然是一个比在你的生产模型变得疯狂的周末修复一些废弃的开源项目的错误更好的选择。最好有一个支持团队，你可以打电话给他们，让他们知道这是他们的问题。</p>



<p>无论如何，假设你想要一个ML元数据管理工具。你能用什么？</p>



<p>有哪些ML元数据存储解决方案？</p>



<p>MLMD(机器学习元数据)</p>



<p>正如<a href="https://web.archive.org/web/20230304071956/https://www.tensorflow.org/tfx/guide/mlmd" target="_blank" rel="noreferrer noopener nofollow">官方文件所说的</a>。</p>



<h3>ML元数据(MLMD)是一个用于记录和检索与ML开发人员和数据科学家工作流相关的元数据的库。MLMD是TensorFlow Extended (TFX)不可或缺的一部分，但其设计可以独立使用。”</h3>



<h4>它是一个开源的管道第一ML元数据存储，支持TensorFlow Extended (TFX)和Kubelfow。</h4>



<p><a href="https://web.archive.org/web/20230304071956/https://www.tensorflow.org/tfx/tutorials" target="_blank" rel="noreferrer noopener nofollow">查看教程</a>并开始学习。</p>



<p>MLflow</p>


<div class="wp-block-image">
<figure class="aligncenter size-full is-resized"><a href="https://web.archive.org/web/20230304071956/https://i0.wp.com/neptune.ai/wp-content/uploads/2022/10/MLDM-components.png?ssl=1"><img decoding="async" loading="lazy" src="../Images/789b9b96cb4cdab455221ce59bb5c12a.png" alt="MLDM components" class="wp-image-50810" data-recalc-dims="1" data-original-src="https://web.archive.org/web/20230304071956im_/https://i0.wp.com/neptune.ai/wp-content/uploads/2022/10/MLDM-components.png?resize=842%2C548&amp;ssl=1"/></a><figcaption class="wp-element-caption"><em>A high-level overview of the various components that are part of MLMD | </em><a href="https://web.archive.org/web/20230304071956/https://www.tensorflow.org/tfx/guide/mlmd" target="_blank" rel="noreferrer noopener nofollow"><em>Source</em></a></figcaption></figure></div>


<p>据<a href="https://web.archive.org/web/20230304071956/https://mlflow.org/" target="_blank" rel="noreferrer noopener nofollow">mlflow.org</a>:</p>



<p>MLflow是一个管理ML生命周期的开源平台，包括实验、再现性、部署和中央模型注册。MLflow目前提供四个组件:MLFlow跟踪、MLFlow项目、MLFlow模型、模型注册"</p>



<h4>这是一个开源的模型优先的ML元数据存储，您可以使用它来跟踪您的实验(MLFlow Tracking)或打包生产模型(Model Registry)。</h4>



<p>如果你有兴趣，可以看看一些使用MLflow的<a href="https://web.archive.org/web/20230304071956/https://mlflow.org/docs/latest/tutorials-and-examples/index.html" target="_blank" rel="noreferrer noopener nofollow">例子。</a></p>



<p>海王星</p>


<div class="wp-block-image">
<figure class="aligncenter size-large"><a href="https://web.archive.org/web/20230304071956/https://i0.wp.com/neptune.ai/wp-content/uploads/2022/10/MLflow-runs-dashboard.png?ssl=1"><img decoding="async" src="../Images/bf8d058656d8bd3d6b0e2b8280bfb8f7.png" alt="MLflow runs dashboard" class="wp-image-50812" data-recalc-dims="1" data-original-src="https://web.archive.org/web/20230304071956im_/https://i0.wp.com/neptune.ai/wp-content/uploads/2022/10/MLflow-runs-dashboard.png?ssl=1"/></a><figcaption class="wp-element-caption"><em>A list of experiment runs with metrics in MLflow UI | </em><a href="https://web.archive.org/web/20230304071956/https://www.mlflow.org/docs/latest/tutorials-and-examples/tutorial.html#training-the-model" target="_blank" rel="noreferrer noopener nofollow"><em>Source</em></a></figcaption></figure></div>


<p>Neptune是MLOps的一个元数据存储库，为运行大量实验的研究和生产团队而构建。</p>



<p>它为您提供了一个中心位置来记录、存储、显示、组织、比较和查询机器学习生命周期中生成的所有元数据。</p>



<h4>个人和组织使用Neptune进行实验跟踪和模型注册，以控制他们的实验和模型开发。</h4>



<p>它<a href="https://web.archive.org/web/20230304071956/https://docs.neptune.ai/you-should-know/what-can-you-log-and-display" target="_blank" rel="noreferrer noopener nofollow">支持许多与ML模型相关的元数据</a>类型，<a href="https://web.archive.org/web/20230304071956/https://docs.neptune.ai/integrations-and-supported-tools/intro" target="_blank" rel="noreferrer noopener nofollow">集成了MLOps生态系统中的大多数库</a>，你可以<a href="https://web.archive.org/web/20230304071956/https://docs.google.com/document/d/1xrmbWXp6noEyiSQXWucMs9PhlO4EXND34Zo28JyQ33U/edit#/register" target="_blank" rel="noreferrer noopener nofollow">在大约5分钟内开始免费使用它</a>。</p>



<p>如果您想了解更多信息:</p>



<p>要了解更多选项，请查看我们写的这篇关于<a href="/web/20230304071956/https://neptune.ai/blog/best-metadata-store-solutions" target="_blank" rel="noreferrer noopener">最佳ML元数据存储解决方案</a>的文章，并对它们进行比较。</p>



<p>最后的想法</p>


<div class="wp-block-image">
<figure class="aligncenter size-large"><a href="https://web.archive.org/web/20230304071956/https://app.neptune.ai/o/common/org/example-project-tensorflow-keras/e/TFKERAS-13/dashboard/summary-6f234f52-6b77-476a-9486-63037655b3be" target="_blank" rel="noopener"><img decoding="async" src="../Images/74c9d5c4d8714c4092d51bd7a1c66424.png" alt="Get started" class="wp-image-50814" data-recalc-dims="1" data-original-src="https://web.archive.org/web/20230304071956im_/https://i0.wp.com/neptune.ai/wp-content/uploads/2022/10/Get-started.png?ssl=1"/></a><figcaption class="wp-element-caption"><em>Example dashboard in Neptune | </em><a href="https://web.archive.org/web/20230304071956/https://app.neptune.ai/o/common/org/example-project-tensorflow-keras/e/TFKERAS-13/dashboard/summary-6f234f52-6b77-476a-9486-63037655b3be" target="_blank" rel="noreferrer noopener"><em>Source</em></a></figcaption></figure></div>


<p>如果你能走到这一步，太好了。感谢您的阅读！</p>







<p>现在，您可能想要自己构建一个ML元数据存储库，设置并维护一个开源工具，或者选择一个付费的解决方案。</p>



<h2 id="h-final-thoughts">我们花了数年时间为许多ML团队构建、修复和改进Neptune，以获得人们真正想要使用的东西。</h2>



<p><strong>所以如果你决定</strong> <a href="/web/20230304071956/https://neptune.ai/pricing" target="_blank" rel="noreferrer noopener"> <strong>试试海王，</strong> </a> <strong>牛逼！</strong></p>



<p>ML模型元数据管理实际上是我们唯一想做好的事情，所以我们略知一二。</p>



<p>如果你走另一个方向，也很棒:)。</p>



<p>当你在自己构建它的时候遇到了障碍，或者受到了其他工具的限制，请联系我们，我们很乐意帮助你。</p>



<p>在那之前，快乐训练！</p>



<p>If you go in the other direction, also great :).</p>



<p>When you hit roadblocks building it yourself or get to limitations of the other tools, just reach out, we’d be happy to help.   </p>



<p>Until then, happy training! </p>
        </div>
        
    </div>    
</body>
</html>