<html>
<head>
<title>Essential Pil (Pillow) Image Tutorial (For Machine Learning People) </title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1>必不可少的Pil(枕头)图像教程(针对机器学习的人)</h1>
<blockquote>原文：<a href="https://web.archive.org/web/https://neptune.ai/blog/pil-image-tutorial-for-machine-learning#0001-01-01">https://web.archive.org/web/https://neptune.ai/blog/pil-image-tutorial-for-machine-learning#0001-01-01</a></blockquote><div><div class="article__content col-lg-10">
<p>PIL代表Python图像库。在本文中，我们将看看它的分叉:枕头。PIL从2011年起就没有更新过，所以枕头的情况很明显。</p>



<p>该库支持各种图像格式，包括流行的JPEG和PNG格式。你会考虑使用枕头的另一个原因是，它很容易使用，而且很受皮托尼斯塔的欢迎。该软件包是大多数处理图像的数据科学家的常用工具。</p>



<p>它还提供了各种图像处理方法，我们将在本文中看到。这些技术非常有用，尤其是在增加计算机视觉问题的训练数据方面。</p>



<p>以下是您可以期望了解到的内容:</p>


<div class="custom-point-list">
<ul><li>如何安装</li><li>枕头的基本概念</li><li>枕头图像类</li><li>用PIL/枕头阅读和书写图像</li><li>枕头图像操作，例如裁剪和旋转图像</li><li>使用枕形滤波器增强图像，例如提高图像质量的滤波器</li><li>在PIL处理图像序列(gif)</li></ul>
</div>





<p>我们走吧！</p>





<h2>安装注意事项</h2>



<p>枕头可以通过pip安装。</p>



<pre class="hljs">pip install Pillow
</pre>



<p>需要注意的是，枕头和PIL包不能在同一环境中共存。因此，确保在安装枕头时没有安装PIL。</p>



<p>现在拿起你的枕头，我们开始吧。</p>





<h2>PIL形象的基本概念</h2>



<p>我们将从理解几个关键的PIL形象概念开始。</p>



<p>为了看到这些概念的实际应用，让我们从使用Pillow加载这个<a href="https://web.archive.org/web/20220926102324/https://unsplash.com/photos/GvyyGV2uWns">图像</a>开始。第一步是从PIL进口<code>Image</code>级。我们将在下一部分详细讨论<code>Image</code>类。</p>


<div class="note">
    <h3>注意:</h3>
    <div class="content">
                    <div class="text">
                                    <p>我们从PIL而不是枕头导入图像类，因为枕头是PIL叉子。因此，展望未来，你应该期待从PIL进口，而不是枕头。</p>
                            </div>
            </div>
</div>


<p id="block_600984288f5b2" class="separator separator-5"/>



<pre class="hljs"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> Image
im = Image.open(<span class="hljs-string">"peacock.png"</span>)</pre>



<p>加载完图像后，让我们开始讨论那些图像概念。</p>





<h3><strong>波段</strong></h3>



<p>每个图像都有一个或多个条带。使用Pillow，我们可以在图像中存储一个或几个波段。例如，一幅彩色图像通常分别有红色、蓝色和绿色的“R”、“G”和“B”波段。</p>



<p>下面是我们如何为上面导入的图像获取波段。</p>



<pre class="hljs">im.getbands()
(<span class="hljs-string">'R'</span>, <span class="hljs-string">'G'</span>, <span class="hljs-string">'B'</span>)
</pre>





<h3><strong>模式</strong></h3>



<p>模式是指图像中像素的类型和深度。目前支持的一些模式有:</p>


<div class="custom-point-list">
<ul><li>l代表黑色和白色</li><li>真彩色的RGB</li><li>带透明遮罩的真彩色RGBA</li><li>彩色视频格式的YCbCr</li></ul>
</div>


<p>下面是我们如何获取上面加载的图像的模式:</p>



<pre class="hljs">im.mode
<span class="hljs-string">'RGB'</span>
</pre>





<h3><strong>尺寸</strong></h3>



<p>我们还可以通过图像属性获得图像的尺寸。</p>


<div class="note">
    <h3>注意:</h3>
    <div class="content">
                    <div class="text">
                                    <p>上面加载的图像非常大，所以我缩小了尺寸，以便在本文后面的部分更容易看到。</p>
                            </div>
            </div>
</div>


<p id="block_600984358f5b3" class="separator separator-5"/>



<pre class="hljs">im.size
(<span class="hljs-number">400</span>, <span class="hljs-number">600</span>)
</pre>





<h3><strong>坐标系</strong></h3>



<p><a href="https://web.archive.org/web/20220926102324/https://pillow.readthedocs.io/en/stable/" target="_blank" rel="noreferrer noopener nofollow">枕</a>包使用笛卡尔像素坐标系。在本文的后面部分，我们将使用这个概念，所以理解它是至关重要的。在这个系统中:</p>


<div class="custom-point-list">
<ul><li>(0，0)是左上角</li><li>坐标作为元组以(x，y)的形式传递</li><li>矩形被表示为4个元组，首先提供左上角。</li></ul>
</div>




<h2>了解图像类</h2>



<p>正如我们前面提到的，在读入我们的<a href="https://web.archive.org/web/20220926102324/https://pillow.readthedocs.io/en/stable/reference/Image.html" target="_blank" rel="noreferrer noopener nofollow">映像</a>之前，我们必须从PIL导入<code>Image</code>类。这个类包含的函数使我们能够加载图像文件以及创建新的图像。接下来，我们将使用的函数已经作为导入<code>Image</code>的结果被导入，除非另有说明。</p>





<h3><strong>加载并保存图像</strong></h3>



<p>我们已经看到，我们可以使用<code>Image.open("peacock.jpg")</code>加载图像，其中<code>peacock.jpg</code>是图像位置的路径。</p>





<h3><strong>从字符串中读取</strong></h3>



<p>为了演示如何使用Pillow读入图像字符串，我们将首先通过<a href="https://web.archive.org/web/20220926102324/https://en.wikipedia.org/wiki/Base64" target="_blank" rel="noreferrer noopener nofollow"> base64 </a>将图像转换为字符串。</p>



<pre class="hljs"><span class="hljs-keyword">import</span> base64

<span class="hljs-keyword">with</span> open(<span class="hljs-string">"peacock.jpg"</span>, <span class="hljs-string">"rb"</span>) <span class="hljs-keyword">as</span> image:
    image_string = base64.b64encode(image.read())</pre>



<p>我们现在可以解码图像字符串，并使用PIL的<code>Image</code>类将其作为图像加载。</p>



<pre class="hljs"><span class="hljs-keyword">import</span> io

image = io.BytesIO(base64.b64decode(image_string))
Image.open(image)</pre>









<h3><strong>转换成JPEG </strong></h3>



<p>现在让我们举一个例子，看看如何将一幅图像转换成JPEG格式。</p>



<h3><strong> PIL保存图像</strong></h3>



<p>图像转换是通过读入图像并以新格式保存来实现的。这里是我们如何将孔雀PNG图像转换为JPEG格式。</p>



<pre class="hljs">im.save(<span class="hljs-string">'peacock.jpg'</span>)</pre>





<h3><strong>创建JPEG缩略图</strong></h3>



<p>在某些情况下，我们会对缩小图像的尺寸感兴趣。</p>



<p>例如，为了获得图像的缩略图，可以缩小图像的尺寸。这可以通过定义缩略图的大小并将其传递给<code>thumbnail</code>图像函数来实现。</p>



<pre class="hljs">size = <span class="hljs-number">128</span>, <span class="hljs-number">128</span>
im.thumbnail(size)
im.save(<span class="hljs-string">'thumb.png'</span>)</pre>









<h2>图像处理</h2>



<p>我们已经看到，我们可以操纵图像的各个方面，如大小。让我们更深入一点，看看其他方面，如图像旋转和颜色转换-仅举几个例子。</p>





<h3><strong>裁剪图像</strong></h3>



<p>为了裁剪一个图像，我们首先定义一个框来指定我们想要裁剪的图像区域。接下来，我们将这个盒子传递给<code>Image</code>类的“crop”函数。</p>



<pre class="hljs">im = Image.open(<span class="hljs-string">'peacock.jpg'</span>)
box = (<span class="hljs-number">100</span>, <span class="hljs-number">150</span>, <span class="hljs-number">300</span>, <span class="hljs-number">300</span>)
cropped_image = im.crop(box)
cropped_image
</pre>









<h3><strong>旋转图像</strong></h3>



<p>旋转图像是通过<code>Image</code>类的<code>rotate</code>函数完成的。</p>



<pre class="hljs">rotated = im.rotate(<span class="hljs-number">180</span>)
rotated</pre>









<h3><strong>合并图像</strong></h3>



<p>该软件包还允许我们合并两个图像。让我们通过将一个徽标合并到孔雀图像中来说明这一点。我们从进口开始。</p>



<pre class="hljs">logo = Image.open(<span class="hljs-string">'logo.png'</span>)</pre>



<p>现在让我们定义标志的位置，并合并两个图像。</p>



<pre class="hljs">position = (<span class="hljs-number">38</span>, <span class="hljs-number">469</span>)
im.paste(logo, position)
im.save(<span class="hljs-string">'merged.jpg'</span>)</pre>



<p>此操作将取代原始图像。所以，如果想保留原图，可以做一个拷贝。</p>



<pre class="hljs">image_copy = image.copy()</pre>







<p>现在，如果您使用PNG图像，您可以利用Pillow的遮罩功能来消除黑色背景。</p>



<pre class="hljs">im = Image.open(<span class="hljs-string">"peacock.jpg"</span>)
image_copy = im.copy()
position = ((image_copy.width - logo.width), (image_copy.height - logo.height))
image_copy.paste(logo, position,logo)
image_copy</pre>









<h3><strong>翻转图像</strong></h3>



<p>现在让我们看看如何翻转上面的图像。这是使用“翻转”方法完成的。一些翻转选项是<code>FLIP_TOP_BOTTOM</code>和<code>FLIP_LEFT_RIGHT</code>。</p>



<pre class="hljs">im.transpose(Image.FLIP_TOP_BOTTOM)</pre>









<h3><strong> PIL图像到NumPy数组</strong></h3>



<p>Pillow还允许我们将图像转换成NumPy数组。将图像转换为NumPy数组后，我们可以使用PIL读取它。</p>



<pre class="hljs"><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np
im_array = np.array(im)</pre>



<p>随着图像的转换，我们现在可以使用枕头加载它。这是使用Pillow的Image类的<code>fromarray</code>函数完成的。最后，我们使用PIL <code>show</code>图像功能保存并显示图像。</p>



<pre class="hljs">img = Image.fromarray(im_array, <span class="hljs-string">'RGB'</span>)
img.save(<span class="hljs-string">'image.png'</span>)
img.show()</pre>





<h3><strong>颜色变换</strong></h3>



<p>我们可以将彩色图像转换成黑白图像，反之亦然。这是通过convert函数并传递首选颜色格式来完成的。</p>



<pre class="hljs">im.convert(<span class="hljs-string">'L'</span>)</pre>







<p>可以用类似的方式转换成彩色。</p>



<pre class="hljs">im.convert(<span class="hljs-string">'RGBA'</span>)</pre>









<h3><strong>在图像上绘图</strong></h3>



<p>我们马上就要结束了，在此之前让我们再看几个项目，包括图片上的<a href="https://web.archive.org/web/20220926102324/https://pillow.readthedocs.io/en/stable/reference/ImageDraw.html?highlight=Color%20Transformations" target="_blank" rel="noreferrer noopener nofollow">画</a>。Pillow允许通过<code>ImageDraw</code>模块来完成，因此，我们从导入它开始。</p>



<pre class="hljs"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span>  ImageDraw</pre>



<p>我们将从定义一个大小为400×400的空白彩色图像开始。然后我们使用<code>ImageDraw</code>来绘制图像。</p>



<pre class="hljs">image = Image.new(<span class="hljs-string">'RGB'</span>, (<span class="hljs-number">400</span>, <span class="hljs-number">400</span>))
img_draw = ImageDraw.Draw(image)</pre>



<p>现在我们可以使用<code>ImageDraw</code>对象在图像上绘制一个矩形。我们用白色填充它，给它一个红色的轮廓。使用相同的对象，我们可以在图像上写一些文字，如图所示。</p>



<pre class="hljs">img_draw.rectangle((<span class="hljs-number">100</span>, <span class="hljs-number">30</span>, <span class="hljs-number">300</span>, <span class="hljs-number">200</span>), outline=<span class="hljs-string">'red'</span>, fill=<span class="hljs-string">'white'</span>)
img_draw.text((<span class="hljs-number">150</span>, <span class="hljs-number">100</span>), <span class="hljs-string">'Neptune AI'</span>, fill=<span class="hljs-string">'red'</span>)
image.save(<span class="hljs-string">'drawing.jpg'</span>)</pre>









<h2>图像增强</h2>



<p>Pillow还附带了使我们能够执行图像增强的功能。这是一个提高图像原始质量的过程。</p>



<p>我们从导入提供这些功能的模块开始。</p>



<pre class="hljs"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> ImageEnhance</pre>



<p>例如，我们可以调整图像的锐度:</p>



<pre class="hljs"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> ImageEnhance
enhancer = ImageEnhance.Sharpness(im)
enhancer.enhance(<span class="hljs-number">10.0</span>)</pre>







<p>让我们再举一个例子，我们把图像的亮度加倍。</p>



<pre class="hljs">enhancer = ImageEnhance.Contrast(im)
enhancer.enhance(<span class="hljs-number">2</span>)</pre>









<h3><strong>过滤器</strong></h3>



<p>我们可以用Pillow做的另一件超级酷的事情是给图像添加<a href="https://web.archive.org/web/20220926102324/https://pillow.readthedocs.io/en/stable/reference/ImageFilter.html?highlight=Filters#filters" target="_blank" rel="noreferrer noopener nofollow">滤镜</a>。第一步是导入<code>ImageFilter</code>模块。</p>



<pre class="hljs"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> ImageFilter</pre>



<p>例如，我们可以像这样模糊图像:</p>



<pre class="hljs"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> ImageFilter
im = Image.open(<span class="hljs-string">"peacock.jpg"</span>)

im.filter(ImageFilter.BLUR)
</pre>







<p>其他可用的过滤器包括:</p>





<pre class="hljs">im.filter(ImageFilter.CONTOUR)</pre>









<pre class="hljs">im.filter(ImageFilter.DETAIL)
</pre>









<pre class="hljs">im.filter(ImageFilter.EDGE_ENHANCE)
</pre>









<pre class="hljs">im.filter(ImageFilter.EMBOSS)</pre>









<pre class="hljs">im.filter(ImageFilter.FIND_EDGES)</pre>









<h2>在PIL处理图像序列(gif)</h2>



<p>我们也可以加载图像序列，如GIF图像。先来导入<a href="https://web.archive.org/web/20220926102324/https://pillow.readthedocs.io/en/stable/reference/ImageSequence.html?highlight=image%20sequence" target="_blank" rel="noreferrer noopener nofollow">图像序列</a>模块。</p>



<pre class="hljs"><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> ImageSequence</pre>



<p>接下来，我们将加载一个GIF文件，并将前两帧保存为PNG文件。因为帧太多，我们中断了循环。</p>



<pre class="hljs">im = Image.open(<span class="hljs-string">"embeddings.GIF"</span>)

frame_num = <span class="hljs-number">1</span>
<span class="hljs-keyword">for</span> frame <span class="hljs-keyword">in</span> ImageSequence.Iterator(im):
    frame.save(<span class="hljs-string">"frame%d.png"</span> % frame_num)
    frame_num = frame_num + <span class="hljs-number">1</span>
    <span class="hljs-keyword">if</span> frame_num == <span class="hljs-number">3</span>:
        <span class="hljs-keyword">break</span></pre>



<p>让我们来看一个已经保存为PNG文件的帧。</p>









<h2>最后的想法</h2>



<p>希望这篇文章能让你对如何在图像处理管道中应用Pillow有所了解。</p>



<p>这种用例的一个例子是在<a href="/web/20220926102324/https://neptune.ai/blog/image-segmentation-in-2020" target="_blank" rel="noreferrer noopener nofollow">图像分割问题</a>中使用的图像增强序列。这将帮助您创建更多的图像实例，最终提高图像分割模型的性能。</p>



<p>现在，让我们回顾一下我们讲述的一些内容:</p>


<div class="custom-point-list">
<ul><li>安装PIL/枕头的过程</li><li>枕头的基本概念</li><li>使用PIL/Pillow中的图像类</li><li>在PIL/枕头上阅读和书写图像</li><li>在Pillow中处理图像</li><li>使用枕头提高图像质量</li><li>给图像添加滤镜</li><li>读取图像序列(gif)</li><li>将枕头图像转换为数字图像</li></ul>
</div>


<p>你可以马上开始应用你在这篇文章中学到的技巧。一个很好的应用示例是深度学习模型的图像增强。综合增加训练数据的数量是提高模型性能的最佳(也是最简单)方法之一。</p>



<p>试试吧！</p>




<div id="author-box-new-format-block_6007356684165" class="article__footer article__author">
  

  <div class="article__authorContent">
          <h3 class="article__authorContent-name">德里克·姆维蒂</h3>
    
          <p class="article__authorContent-text">Derrick Mwiti是一名数据科学家，他对分享知识充满热情。他是数据科学社区的热心贡献者，例如Heartbeat、Towards Data Science、Datacamp、Neptune AI、KDnuggets等博客。他的内容在网上被浏览了超过一百万次。德里克也是一名作家和在线教师。他还培训各种机构并与之合作，以实施数据科学解决方案并提升其员工的技能。你可能想看看他在Python课程中完整的数据科学和机器学习训练营。</p>
    
          
    
  </div>
</div>


<div class="wp-container-1 wp-block-group"><div class="wp-block-group__inner-container">
<hr class="wp-block-separator"/>



<p class="has-text-color"><strong>阅读下一篇</strong></p>



<h2>Python中的图像处理:你应该知道的算法、工具和方法</h2>



<p class="has-small-font-size">9分钟阅读|作者Neetika Khandelwal |更新于2021年5月27日</p>


<p id="block_5ffc75def9f8e" class="separator separator-10"/>



<p>图像定义了世界，每张图像都有自己的故事，它包含了许多在许多方面都有用的重要信息。这些信息可以借助于被称为<strong>图像处理</strong>的技术来获得。</p>



<p>它是计算机视觉的核心部分，在机器人、自动驾驶汽车和物体检测等许多现实世界的例子中起着至关重要的作用。图像处理允许我们一次转换和操作数千幅图像，并从中提取有用的见解。它在几乎每个领域都有广泛的应用。</p>



<p>Python是为此目的广泛使用的编程语言之一。它惊人的库和工具有助于非常有效地完成图像处理任务。</p>



<p>通过本文，您将了解处理图像并获得所需输出的经典算法、技术和工具。</p>



<p>让我们开始吧！</p>


<a class="button continous-post blue-filled" href="/web/20220926102324/https://neptune.ai/blog/image-processing-in-python-algorithms-tools-and-methods-you-should-know" target="_blank">
    Continue reading -&gt;</a>



<hr class="wp-block-separator"/>
</div></div>
</div>
      </div>    
</body>
</html>